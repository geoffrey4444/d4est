(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[     62111,       1503]
NotebookOptionsPosition[     58966,       1407]
NotebookOutlinePosition[     59300,       1422]
CellTagsIndexPosition[     59257,       1419]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"[", 
      RowBox[{"amin", ",", "amax"}], "]"}], " ", "are", " ", "the", " ", 
     "x"}], "-", 
    RowBox[{
    "corners", " ", "of", " ", "the", " ", "element", " ", "in", " ", "the", 
     " ", "topological", " ", 
     RowBox[{"space", " ", "[", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "]"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"[", 
      RowBox[{"bmin", ",", "bmax"}], "]"}], " ", "are", " ", "the", " ", 
     "x"}], "-", 
    RowBox[{
    "corners", " ", "of", " ", "the", " ", "element", " ", "in", " ", "the", 
     " ", "topological", " ", 
     RowBox[{"space", " ", "[", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "]"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"[", 
      RowBox[{"cmin", ",", "cmax"}], "]"}], " ", "are", " ", "the", " ", 
     "x"}], "-", 
    RowBox[{
    "corners", " ", "of", " ", "the", " ", "element", " ", "in", " ", "the", 
     " ", "topological", " ", 
     RowBox[{"space", " ", "[", 
      RowBox[{"1", ",", "2"}], "]"}]}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.699546556880673*^9, 3.699546556881516*^9}, 
   3.699546668068795*^9, 3.699549373231655*^9, 3.699550523439896*^9, {
   3.700095466637554*^9, 3.700095466981565*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", "r_", "]"}], ":=", 
   RowBox[{"amin", " ", "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"amax", "-", "amin"}], ")"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"r", "+", "1"}], ")"}], "/", "2"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b", "[", "s_", "]"}], ":=", 
   RowBox[{"bmin", " ", "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"bmax", "-", "bmin"}], ")"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"s", "+", "1"}], ")"}], "/", "2"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"c", "[", "t_", "]"}], ":=", 
   RowBox[{"cmin", " ", "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"cmax", "-", "cmin"}], ")"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"t", "+", "1"}], ")"}], "/", "2"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6995419796783953`*^9, 3.699542033818336*^9}, {
  3.699544419647629*^9, 3.699544421151099*^9}, {3.6995480954441853`*^9, 
  3.699548098390929*^9}, {3.6995481289073153`*^9, 3.6995481427235518`*^9}, {
  3.700095431128735*^9, 3.700095432882806*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"R", "[", "t_", "]"}], ":=", 
   RowBox[{
    RowBox[{"R1", "*", 
     RowBox[{"(", 
      RowBox[{"2", "-", 
       RowBox[{"c", "[", "t", "]"}]}], ")"}]}], "+", 
    RowBox[{"R2", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", "[", "t", "]"}], "-", "1"}], ")"}]}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.6995432899345407`*^9, 3.699543289935378*^9}, {
  3.699543411139988*^9, 3.6995434595761623`*^9}, {3.69954664339493*^9, 
  3.6995466448564053`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"x", "[", "r_", "]"}], ":=", 
   RowBox[{"Tan", " ", "[", 
    RowBox[{
     RowBox[{"a", "[", "r", "]"}], "*", 
     RowBox[{"\[Pi]", "/", "4"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"y", "[", "s_", "]"}], ":=", 
   RowBox[{"Tan", " ", "[", 
    RowBox[{
     RowBox[{"b", "[", "s", "]"}], "*", 
     RowBox[{"\[Pi]", "/", "4"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"q", "[", 
    RowBox[{"r_", ",", "s_", ",", "t_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"R", "[", "t", "]"}], "/", 
    RowBox[{"Sqrt", " ", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "r", "]"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"y", "[", "s", "]"}], "^", "2"}], "+", "1"}], "]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"xf", "[", 
    RowBox[{"r_", ",", "s_", ",", "t_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"+", 
     RowBox[{"q", "[", 
      RowBox[{"r", ",", "s", ",", "t"}], "]"}]}], "*", 
    RowBox[{"x", "[", "r", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"yf", "[", 
    RowBox[{"r_", ",", "s_", ",", "t_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"+", 
     RowBox[{"q", "[", 
      RowBox[{"r", ",", "s", ",", "t"}], "]"}]}], "*", 
    RowBox[{"y", "[", "s", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zf", "[", 
    RowBox[{"r_", ",", "s_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"+", 
    RowBox[{"q", "[", 
     RowBox[{"r", ",", "s", ",", "t"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.69954197218334*^9, 3.699541972184321*^9}, {
  3.699542129577129*^9, 3.699542220945642*^9}, {3.699543118381762*^9, 
  3.6995434063743362`*^9}, {3.699543816973815*^9, 3.699543824968581*^9}, {
  3.6995438748435307`*^9, 3.699543883914052*^9}, {3.699544413357587*^9, 
  3.699544418654728*^9}, {3.699546573829671*^9, 3.69954667122686*^9}, {
  3.699846093980824*^9, 3.699846095190308*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xr", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"xf", "[", 
      RowBox[{"r", ",", "s", ",", "t"}], "]"}], ",", "r"}], "]"}]}], ";", " ", 
  RowBox[{"xs", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"xf", "[", 
      RowBox[{"r", ",", "s", ",", "t"}], "]"}], ",", "s"}], "]"}]}], ";", " ", 
  RowBox[{"xt", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"xf", "[", 
      RowBox[{"r", ",", "s", ",", "t"}], "]"}], ",", "t"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yr", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"yf", "[", 
      RowBox[{"r", ",", "s", ",", "t"}], "]"}], ",", "r"}], "]"}]}], ";", " ", 
  RowBox[{"ys", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"yf", "[", 
      RowBox[{"r", ",", "s", ",", "t"}], "]"}], ",", "s"}], "]"}]}], ";", " ", 
  RowBox[{"yt", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"yf", "[", 
      RowBox[{"r", ",", "s", ",", "t"}], "]"}], ",", "t"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zr", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"zf", "[", 
      RowBox[{"r", ",", "s", ",", "t"}], "]"}], ",", "r"}], "]"}]}], ";", 
  "  ", 
  RowBox[{"zs", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"zf", "[", 
      RowBox[{"r", ",", "s", ",", "t"}], "]"}], ",", "s"}], "]"}]}], ";", 
  RowBox[{"zt", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"zf", "[", 
      RowBox[{"r", ",", "s", ",", "t"}], "]"}], ",", "t"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.702779513987832*^9, 3.702779518237679*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dxdr", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xr", ",", "xs", ",", "xt"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"yr", ",", "ys", ",", "yt"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"zr", ",", "zs", ",", "zt"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J", " ", "=", " ", 
   RowBox[{
    RowBox[{"xr", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ys", "*", "zt"}], "-", 
       RowBox[{"zs", "*", "yt"}]}], ")"}]}], "-", 
    RowBox[{"yr", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"xs", "*", "zt"}], "-", 
       RowBox[{"zs", "*", "xt"}]}], ")"}]}], "-", 
    RowBox[{"yr", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"xs", "*", "zt"}], "-", 
       RowBox[{"zs", "*", "xt"}]}], ")"}]}], "+", 
    RowBox[{"zr", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"xs", "*", "yt"}], "-", 
       RowBox[{"ys", "*", "xt"}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drdx", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ys", "*", "zt"}], "-", 
          RowBox[{"zs", "*", "yt"}]}], ")"}], "/", 
        RowBox[{"(", "J", ")"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"xs", "*", "zt"}], "-", 
           RowBox[{"zs", "*", "xt"}]}], ")"}]}], "/", 
        RowBox[{"(", "J", ")"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"xs", "*", "yt"}], "-", 
          RowBox[{"ys", "*", "xt"}]}], ")"}], "/", 
        RowBox[{"(", "J", ")"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"yr", "*", "zt"}], "-", 
           RowBox[{"zr", "*", "yt"}]}], ")"}]}], "/", 
        RowBox[{"(", "J", ")"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"xr", "*", "zt"}], "-", 
          RowBox[{"zr", "*", "xt"}]}], ")"}], "/", 
        RowBox[{"(", "J", ")"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"xr", "*", "yt"}], "-", 
           RowBox[{"yr", "*", "xt"}]}], ")"}]}], "/", 
        RowBox[{"(", "J", ")"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"yr", "*", "zs"}], "-", 
          RowBox[{"zr", "*", "ys"}]}], ")"}], "/", 
        RowBox[{"(", "J", ")"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"xr", "*", "zs"}], "-", 
           RowBox[{"zr", "*", "xs"}]}], ")"}]}], "/", 
        RowBox[{"(", "J", ")"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"xr", "*", "ys"}], "-", 
          RowBox[{"yr", "*", "xs"}]}], ")"}], "/", 
        RowBox[{"(", "J", ")"}]}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drdxJ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ys", "*", "zt"}], "-", 
         RowBox[{"zs", "*", "yt"}]}], ")"}], ",", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"xs", "*", "zt"}], "-", 
          RowBox[{"zs", "*", "xt"}]}], ")"}]}], ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xs", "*", "yt"}], "-", 
         RowBox[{"ys", "*", "xt"}]}], ")"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"yr", "*", "zt"}], "-", 
          RowBox[{"zr", "*", "yt"}]}], ")"}]}], ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xr", "*", "zt"}], "-", 
         RowBox[{"zr", "*", "xt"}]}], ")"}], ",", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"xr", "*", "yt"}], "-", 
          RowBox[{"yr", "*", "xt"}]}], ")"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"yr", "*", "zs"}], "-", 
         RowBox[{"zr", "*", "ys"}]}], ")"}], ",", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"xr", "*", "zs"}], "-", 
          RowBox[{"zr", "*", "xs"}]}], ")"}]}], ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xr", "*", "ys"}], "-", 
         RowBox[{"yr", "*", "xs"}]}], ")"}]}], "}"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.702767921136414*^9, 3.702767972559712*^9}, {
   3.702768004826379*^9, 3.702768015603003*^9}, 3.702768077269484*^9, {
   3.702777238064062*^9, 3.7027773244753647`*^9}, {3.702778082050069*^9, 
   3.702778087077029*^9}, {3.702778327875937*^9, 3.702778374874288*^9}, {
   3.70277920718671*^9, 3.702779225061974*^9}, {3.702779361193205*^9, 
   3.702779377904117*^9}, 3.702943356913886*^9, 3.702943394751157*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<dxyz_drst[\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"i", "-", "1"}], "]"}], ",", "\"\<][\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"j", "-", "1"}], "]"}], ",", "\"\<] = \>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"CForm", "[", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"dxdr", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "]"}], ",", 
        "\"\<;\>\""}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", " ", 
        RowBox[{"\"\<Pi\>\"", "\[Rule]", "\"\<M_PI\>\""}], ",", 
        RowBox[{"\"\<Sin\>\"", "\[Rule]", "\"\<sin\>\""}], ",", 
        RowBox[{"\"\<Cos\>\"", "\[Rule]", "\"\<cos\>\""}], ",", 
        RowBox[{"\"\<Tan\>\"", "\[Rule]", "\"\<tan\>\""}], ",", 
        RowBox[{"\"\<Sqrt\>\"", "->", "\"\<sqrt\>\""}], ",", 
        RowBox[{"\"\<Sec\>\"", "\[Rule]", "\"\<secant_fcn\>\""}]}], "}"}]}], 
     "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<jacobian = \>\"", ",", 
     RowBox[{"ToString", "[", 
      RowBox[{"CForm", "[", 
       RowBox[{"Simplify", "[", "J", "]"}], "]"}], " ", "]"}], " ", ",", " ", 
     "\"\<;\>\""}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", " ", 
     RowBox[{"\"\<Pi\>\"", "\[Rule]", "\"\<M_PI\>\""}], ",", 
     RowBox[{"\"\<Sin\>\"", "\[Rule]", "\"\<sin\>\""}], ",", 
     RowBox[{"\"\<Cos\>\"", "\[Rule]", "\"\<cos\>\""}], ",", 
     RowBox[{"\"\<Tan\>\"", "\[Rule]", "\"\<tan\>\""}], ",", 
     RowBox[{"\"\<Sqrt\>\"", "->", "\"\<sqrt\>\""}], ",", 
     RowBox[{"\"\<Sec\>\"", "\[Rule]", "\"\<secant_fcn\>\""}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<drst_dxyz[\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"i", "-", "1"}], "]"}], ",", "\"\<][\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"j", "-", "1"}], "]"}], ",", "\"\<] = \>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"CForm", "[", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"drdx", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "]"}], ",", 
        "\"\<;\>\""}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", " ", 
        RowBox[{"\"\<Pi\>\"", "\[Rule]", "\"\<M_PI\>\""}], ",", 
        RowBox[{"\"\<Sin\>\"", "\[Rule]", "\"\<sin\>\""}], ",", 
        RowBox[{"\"\<Cos\>\"", "\[Rule]", "\"\<cos\>\""}], ",", 
        RowBox[{"\"\<Tan\>\"", "\[Rule]", "\"\<tan\>\""}], ",", 
        RowBox[{"\"\<Sqrt\>\"", "->", "\"\<sqrt\>\""}], ",", 
        RowBox[{"\"\<Sec\>\"", "\[Rule]", "\"\<secant_fcn\>\""}]}], "}"}]}], 
     "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<drst_dxyz_times_jac[\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"i", "-", "1"}], "]"}], ",", "\"\<][\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"j", "-", "1"}], "]"}], ",", "\"\<] = \>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"CForm", "[", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"drdxJ", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "]"}], ",", 
        "\"\<;\>\""}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", " ", 
        RowBox[{"\"\<Pi\>\"", "\[Rule]", "\"\<M_PI\>\""}], ",", 
        RowBox[{"\"\<Sin\>\"", "\[Rule]", "\"\<sin\>\""}], ",", 
        RowBox[{"\"\<Cos\>\"", "\[Rule]", "\"\<cos\>\""}], ",", 
        RowBox[{"\"\<Tan\>\"", "\[Rule]", "\"\<tan\>\""}], ",", 
        RowBox[{"\"\<Sqrt\>\"", "->", "\"\<sqrt\>\""}], ",", 
        RowBox[{"\"\<Sec\>\"", "\[Rule]", "\"\<secant_fcn\>\""}]}], "}"}]}], 
     "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<drdxJdrdx[\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"i", "-", "1"}], "]"}], ",", "\"\<][\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"j", "-", "1"}], "]"}], ",", "\"\<] = \>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"CForm", "[", 
          RowBox[{"Simplify", "[", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"drdxJ", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{
               RowBox[{"drdx", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}], "]"}],
          "]"}], ",", "\"\<;\>\""}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", " ", 
        RowBox[{"\"\<Pi\>\"", "\[Rule]", "\"\<M_PI\>\""}], ",", 
        RowBox[{"\"\<Sin\>\"", "\[Rule]", "\"\<sin\>\""}], ",", 
        RowBox[{"\"\<Cos\>\"", "\[Rule]", "\"\<cos\>\""}], ",", 
        RowBox[{"\"\<Tan\>\"", "\[Rule]", "\"\<tan\>\""}], ",", 
        RowBox[{"\"\<Sqrt\>\"", "->", "\"\<sqrt\>\""}], ",", 
        RowBox[{"\"\<Sec\>\"", "\[Rule]", "\"\<secant_fcn\>\""}]}], "}"}]}], 
     "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<drst_dxyz[\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"i", "-", "1"}], "]"}], ",", "\"\<][\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"j", "-", "1"}], "]"}], ",", "\"\<] = \>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"CForm", "[", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"drdx", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "]"}], ",", 
        "\"\<;\>\""}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", " ", 
        RowBox[{"\"\<Pi\>\"", "\[Rule]", "\"\<M_PI\>\""}], ",", 
        RowBox[{"\"\<Sin\>\"", "\[Rule]", "\"\<sin\>\""}], ",", 
        RowBox[{"\"\<Cos\>\"", "\[Rule]", "\"\<cos\>\""}], ",", 
        RowBox[{"\"\<Tan\>\"", "\[Rule]", "\"\<tan\>\""}], ",", 
        RowBox[{"\"\<Sqrt\>\"", "->", "\"\<sqrt\>\""}], ",", 
        RowBox[{"\"\<Sec\>\"", "\[Rule]", "\"\<secant_fcn\>\""}]}], "}"}]}], 
     "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.702778489546298*^9, 3.702778594954393*^9}, {
  3.702778625551796*^9, 3.702778626464368*^9}, {3.70277868394108*^9, 
  3.7027788308919477`*^9}, {3.702778901658266*^9, 3.702779035406241*^9}, {
  3.702779197247562*^9, 3.702779202315544*^9}, {3.7027795307489634`*^9, 
  3.7027795782886477`*^9}, {3.7027796984286203`*^9, 3.702779711578933*^9}, {
  3.702779743306527*^9, 3.70277981029527*^9}, {3.7028287944763308`*^9, 
  3.7028288114599447`*^9}, {3.702841379060328*^9, 3.702841380930273*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"dxyz_drst[0][0] = -((amax - amin)*M_PI*(R1*(-4 + cmax + \
cmin + cmax*t - cmin*t) - R2*(-2 + cmax + cmin + cmax*t - \
cmin*t))*pow(secant_fcn((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)*pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2))/(16.*pow(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2),1.5));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.710799738493947*^9}],

Cell[BoxData["\<\"dxyz_drst[0][1] = ((bmax - bmin)*M_PI*(R1*(-4 + cmax + cmin \
+ cmax*t - cmin*t) - R2*(-2 + cmax + cmin + cmax*t - \
cmin*t))*pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2)*tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.)*tan((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.))/(16.*pow(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2),1.5));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.710799738894125*^9}],

Cell[BoxData["\<\"dxyz_drst[0][2] = -((cmax - cmin)*(R1 - R2)*tan((M_PI*(amax \
+ amin + amax*r - amin*r))/8.))/(2.*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + \
bmax*s - bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.7107997390285873`*^9}],

Cell[BoxData["\<\"dxyz_drst[1][0] = ((amax - amin)*M_PI*(R1*(-4 + cmax + cmin \
+ cmax*t - cmin*t) - R2*(-2 + cmax + cmin + cmax*t - \
cmin*t))*pow(secant_fcn((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)*tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.)*tan((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.))/(16.*pow(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2),1.5));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.710799739450267*^9}],

Cell[BoxData["\<\"dxyz_drst[1][1] = -((bmax - bmin)*M_PI*(R1*(-4 + cmax + \
cmin + cmax*t - cmin*t) - R2*(-2 + cmax + cmin + cmax*t - \
cmin*t))*pow(secant_fcn((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)*pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2))/(16.*pow(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2),1.5));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.710799740117096*^9}],

Cell[BoxData["\<\"dxyz_drst[1][2] = -((cmax - cmin)*(R1 - R2)*tan((M_PI*(bmax \
+ bmin + bmax*s - bmin*s))/8.))/(2.*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + \
bmax*s - bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.7107997402406607`*^9}],

Cell[BoxData["\<\"dxyz_drst[2][0] = ((amax - amin)*M_PI*(R1*(-4 + cmax + cmin \
+ cmax*t - cmin*t) - R2*(-2 + cmax + cmin + cmax*t - \
cmin*t))*pow(secant_fcn((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)*tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.))/(16.*pow(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2),1.5));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.710799740550559*^9}],

Cell[BoxData["\<\"dxyz_drst[2][1] = ((bmax - bmin)*M_PI*(R1*(-4 + cmax + cmin \
+ cmax*t - cmin*t) - R2*(-2 + cmax + cmin + cmax*t - \
cmin*t))*pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2)*tan((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.))/(16.*pow(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2),1.5));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.710799740885235*^9}],

Cell[BoxData["\<\"dxyz_drst[2][2] = -((cmax - cmin)*(R1 - \
R2))/(2.*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - bmin*s))/8.),2) + \
pow(tan((M_PI*(amax + amin + amax*r - amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.710799741003014*^9}]
}, Open  ]],

Cell[BoxData["\<\"jacobian = -((amax - amin)*(bmax - bmin)*(cmax - \
cmin)*pow(M_PI,2)*(R1 - R2)*pow(R1*(-4 + cmax + cmin + cmax*t - cmin*t) - \
R2*(-2 + cmax + cmin + cmax*t - cmin*t),2)*pow(secant_fcn((M_PI*(amax + amin \
+ amax*r - amin*r))/8.),2)*pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2))/(512.*pow(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2),1.5));\"\>"], "Output",
 CellChangeTimes->{
  3.702858900333477*^9, 3.702859532657661*^9, {3.702943382379581*^9, 
   3.702943401947956*^9}, 3.709472791222629*^9, 3.7104500012568073`*^9, 
   3.710798438692463*^9, 3.710798742833542*^9, 3.710799124984613*^9, 
   3.7107995962087812`*^9, 3.710799743460362*^9}],

Cell[CellGroupData[{

Cell[BoxData["\<\"drst_dxyz[0][0] = (-16*pow(cos((M_PI*(amax + amin + amax*r \
- amin*r))/8.),2)*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)))/((amax - amin)*M_PI*(R1*(-4 + cmax + cmin + cmax*t - \
cmin*t) - R2*(-2 + cmax + cmin + cmax*t - cmin*t)));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.7107997436399307`*^9}],

Cell[BoxData["\<\"drst_dxyz[0][1] = 0;\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.710799743641325*^9}],

Cell[BoxData["\<\"drst_dxyz[0][2] = (8*sin((M_PI*(amax + amin + amax*r - \
amin*r))/4.)*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)))/((amax - amin)*M_PI*(R1*(-4 + cmax + cmin + cmax*t - \
cmin*t) - R2*(-2 + cmax + cmin + cmax*t - cmin*t)));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.7107997437729807`*^9}],

Cell[BoxData["\<\"drst_dxyz[1][0] = 0;\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.710799743775084*^9}],

Cell[BoxData["\<\"drst_dxyz[1][1] = (-16*pow(cos((M_PI*(bmax + bmin + bmax*s \
- bmin*s))/8.),2)*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)))/((bmax - bmin)*M_PI*(R1*(-4 + cmax + cmin + cmax*t - \
cmin*t) - R2*(-2 + cmax + cmin + cmax*t - cmin*t)));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.710799743960825*^9}],

Cell[BoxData["\<\"drst_dxyz[1][2] = (8*sin((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/4.)*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)))/((bmax - bmin)*M_PI*(R1*(-4 + cmax + cmin + cmax*t - \
cmin*t) - R2*(-2 + cmax + cmin + cmax*t - cmin*t)));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.710799744097815*^9}],

Cell[BoxData["\<\"drst_dxyz[2][0] = (-2*tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.))/((cmax - cmin)*(R1 - R2)*sqrt(pow(secant_fcn((M_PI*(bmax + bmin \
+ bmax*s - bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.7107997442925777`*^9}],

Cell[BoxData["\<\"drst_dxyz[2][1] = (-2*tan((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.))/((cmax - cmin)*(R1 - R2)*sqrt(pow(secant_fcn((M_PI*(bmax + bmin \
+ bmax*s - bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.710799744437903*^9}],

Cell[BoxData["\<\"drst_dxyz[2][2] = -2/((cmax - cmin)*(R1 - \
R2)*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - bmin*s))/8.),2) + \
pow(tan((M_PI*(amax + amin + amax*r - amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.7107997445855103`*^9}],

Cell[BoxData["\<\"drst_dxyz_times_jac[0][0] = ((bmax - bmin)*(cmax - \
cmin)*M_PI*(R1 - R2)*(R1*(-4 + cmax + cmin + cmax*t - cmin*t) - R2*(-2 + cmax \
+ cmin + cmax*t - cmin*t))*pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2))/(32.*(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.710799744775435*^9}],

Cell[BoxData["\<\"drst_dxyz_times_jac[0][1] = 0;\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.710799744777533*^9}],

Cell[BoxData["\<\"drst_dxyz_times_jac[0][2] = -((bmax - bmin)*(cmax - \
cmin)*M_PI*(R1 - R2)*(R1*(-4 + cmax + cmin + cmax*t - cmin*t) - R2*(-2 + cmax \
+ cmin + cmax*t - cmin*t))*pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2)*tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.))/(32.*(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.710799745078168*^9}],

Cell[BoxData["\<\"drst_dxyz_times_jac[1][0] = 0;\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.7107997450802317`*^9}],

Cell[BoxData["\<\"drst_dxyz_times_jac[1][1] = ((amax - amin)*(cmax - \
cmin)*M_PI*(R1 - R2)*(R1*(-4 + cmax + cmin + cmax*t - cmin*t) - R2*(-2 + cmax \
+ cmin + cmax*t - cmin*t))*pow(secant_fcn((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2))/(32.*(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.710799745304626*^9}],

Cell[BoxData["\<\"drst_dxyz_times_jac[1][2] = -((amax - amin)*(cmax - \
cmin)*M_PI*(R1 - R2)*(R1*(-4 + cmax + cmin + cmax*t - cmin*t) - R2*(-2 + cmax \
+ cmin + cmax*t - cmin*t))*pow(secant_fcn((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)*tan((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.))/(32.*(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.710799745613895*^9}],

Cell[BoxData["\<\"drst_dxyz_times_jac[2][0] = ((amax - amin)*(bmax - \
bmin)*pow(M_PI,2)*pow(R1*(-4 + cmax + cmin + cmax*t - cmin*t) - R2*(-2 + cmax \
+ cmin + cmax*t - cmin*t),2)*pow(secant_fcn((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)*pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2)*tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.))/(256.*pow(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2),2));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.710799746118718*^9}],

Cell[BoxData["\<\"drst_dxyz_times_jac[2][1] = ((amax - amin)*(bmax - \
bmin)*pow(M_PI,2)*pow(R1*(-4 + cmax + cmin + cmax*t - cmin*t) - R2*(-2 + cmax \
+ cmin + cmax*t - cmin*t),2)*pow(secant_fcn((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)*pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2)*tan((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.))/(256.*pow(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2),2));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.71079974651943*^9}],

Cell[BoxData["\<\"drst_dxyz_times_jac[2][2] = ((amax - amin)*(bmax - \
bmin)*pow(M_PI,2)*pow(R1*(-4 + cmax + cmin + cmax*t - cmin*t) - R2*(-2 + cmax \
+ cmin + cmax*t - cmin*t),2)*pow(secant_fcn((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)*pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2))/(256.*pow(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2),2));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.7107997472472353`*^9}],

Cell[BoxData["\<\"drdxJdrdx[0][0] = -((bmax - bmin)*(cmax - cmin)*(R1 - \
R2)*pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - bmin*s))/8.),2))/(2.*(amax - \
amin)*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - bmin*s))/8.),2) + \
pow(tan((M_PI*(amax + amin + amax*r - amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.710799747503285*^9}],

Cell[BoxData["\<\"drdxJdrdx[0][1] = -((cmax - cmin)*(R1 - R2)*tan((M_PI*(amax \
+ amin + amax*r - amin*r))/8.)*tan((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.))/(2.*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.710799747737577*^9}],

Cell[BoxData["\<\"drdxJdrdx[0][2] = 0;\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.710799747928287*^9}],

Cell[BoxData["\<\"drdxJdrdx[1][0] = -((cmax - cmin)*(R1 - R2)*tan((M_PI*(amax \
+ amin + amax*r - amin*r))/8.)*tan((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.))/(2.*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.710799747930458*^9}],

Cell[BoxData["\<\"drdxJdrdx[1][1] = -((amax - amin)*(cmax - cmin)*(R1 - \
R2)*pow(secant_fcn((M_PI*(amax + amin + amax*r - amin*r))/8.),2))/(2.*(bmax - \
bmin)*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - bmin*s))/8.),2) + \
pow(tan((M_PI*(amax + amin + amax*r - amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.7107997481291447`*^9}],

Cell[BoxData["\<\"drdxJdrdx[1][2] = 0;\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.710799748314283*^9}],

Cell[BoxData["\<\"drdxJdrdx[2][0] = 0;\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.710799748316286*^9}],

Cell[BoxData["\<\"drdxJdrdx[2][1] = 0;\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.7107997483178663`*^9}],

Cell[BoxData["\<\"drdxJdrdx[2][2] = -((amax - amin)*(bmax - \
bmin)*pow(M_PI,2)*pow(R1*(-4 + cmax + cmin + cmax*t - cmin*t) - R2*(-2 + cmax \
+ cmin + cmax*t - cmin*t),2)*pow(secant_fcn((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)*pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2))/(128.*(cmax - cmin)*(R1 - R2)*pow(pow(secant_fcn((M_PI*(bmax \
+ bmin + bmax*s - bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2),1.5));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.710799749997278*^9}],

Cell[BoxData["\<\"drst_dxyz[0][0] = (-16*pow(cos((M_PI*(amax + amin + amax*r \
- amin*r))/8.),2)*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)))/((amax - amin)*M_PI*(R1*(-4 + cmax + cmin + cmax*t - \
cmin*t) - R2*(-2 + cmax + cmin + cmax*t - cmin*t)));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.7107997501891527`*^9}],

Cell[BoxData["\<\"drst_dxyz[0][1] = 0;\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.7107997501919737`*^9}],

Cell[BoxData["\<\"drst_dxyz[0][2] = (8*sin((M_PI*(amax + amin + amax*r - \
amin*r))/4.)*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)))/((amax - amin)*M_PI*(R1*(-4 + cmax + cmin + cmax*t - \
cmin*t) - R2*(-2 + cmax + cmin + cmax*t - cmin*t)));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.710799750194528*^9}],

Cell[BoxData["\<\"drst_dxyz[1][0] = 0;\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.710799750197033*^9}],

Cell[BoxData["\<\"drst_dxyz[1][1] = (-16*pow(cos((M_PI*(bmax + bmin + bmax*s \
- bmin*s))/8.),2)*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)))/((bmax - bmin)*M_PI*(R1*(-4 + cmax + cmin + cmax*t - \
cmin*t) - R2*(-2 + cmax + cmin + cmax*t - cmin*t)));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.71079975019879*^9}],

Cell[BoxData["\<\"drst_dxyz[1][2] = (8*sin((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/4.)*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)))/((bmax - bmin)*M_PI*(R1*(-4 + cmax + cmin + cmax*t - \
cmin*t) - R2*(-2 + cmax + cmin + cmax*t - cmin*t)));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.7107997502527122`*^9}],

Cell[BoxData["\<\"drst_dxyz[2][0] = (-2*tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.))/((cmax - cmin)*(R1 - R2)*sqrt(pow(secant_fcn((M_PI*(bmax + bmin \
+ bmax*s - bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.710799750519383*^9}],

Cell[BoxData["\<\"drst_dxyz[2][1] = (-2*tan((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.))/((cmax - cmin)*(R1 - R2)*sqrt(pow(secant_fcn((M_PI*(bmax + bmin \
+ bmax*s - bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.710799750521154*^9}],

Cell[BoxData["\<\"drst_dxyz[2][2] = -2/((cmax - cmin)*(R1 - \
R2)*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - bmin*s))/8.),2) + \
pow(tan((M_PI*(amax + amin + amax*r - amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{
  3.702858895437563*^9, 3.702859529045171*^9, {3.7029433774470377`*^9, 
   3.7029433977320223`*^9}, 3.709472784980876*^9, 3.7104499956982594`*^9, 
   3.71079843207801*^9, 3.710798739083733*^9, 3.71079912110946*^9, 
   3.710799590427919*^9, 3.710799750522398*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rad2", "[", 
   RowBox[{"r_", ",", "s_", ",", "t_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"xf", "[", 
     RowBox[{"r", ",", "s", ",", "t"}], "]"}], "^", "2"}], "+", 
   RowBox[{
    RowBox[{"yf", "[", 
     RowBox[{"r", ",", "s", ",", "t"}], "]"}], "^", "2"}], "+", 
   RowBox[{
    RowBox[{"zf", "[", 
     RowBox[{"r", ",", "s", ",", "t"}], "]"}], "^", 
    "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"rad2", "[", 
   RowBox[{"r", ",", "s", ",", "t"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.709472709679329*^9, 3.709472762717609*^9}, {
  3.7094728439949417`*^9, 3.709472848539534*^9}, {3.7104499848018923`*^9, 
  3.710450025668283*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"R1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "4"}], "+", "cmax", "+", "cmin", "+", 
        RowBox[{"cmax", " ", "t"}], "-", 
        RowBox[{"cmin", " ", "t"}]}], ")"}]}], "-", 
     RowBox[{"R2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "cmax", "+", "cmin", "+", 
        RowBox[{"cmax", " ", "t"}], "-", 
        RowBox[{"cmin", " ", "t"}]}], ")"}]}]}], ")"}], "2"]}]], "Output",
 CellChangeTimes->{{3.710449988247941*^9, 3.710450026161798*^9}, 
   3.710798447299045*^9, 3.7107987481291103`*^9, 3.710799129933329*^9, 
   3.710799601944254*^9, 3.710799750948921*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Sqrt", "[", 
   RowBox[{"rad2", "[", 
    RowBox[{"r", ",", "s", ",", "t"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7094727548648043`*^9, 3.709472764670499*^9}, {
   3.709472809303393*^9, 3.709472813111422*^9}, 3.709472845307785*^9, {
   3.709472877776824*^9, 3.7094729159688873`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  SqrtBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"R1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "4"}], "+", "cmax", "+", "cmin", "+", 
         RowBox[{"cmax", " ", "t"}], "-", 
         RowBox[{"cmin", " ", "t"}]}], ")"}]}], "-", 
      RowBox[{"R2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "cmax", "+", "cmin", "+", 
         RowBox[{"cmax", " ", "t"}], "-", 
         RowBox[{"cmin", " ", "t"}]}], ")"}]}]}], ")"}], "2"]]}]], "Output",
 CellChangeTimes->{{3.709472799334519*^9, 3.709472814087604*^9}, {
   3.709472850883819*^9, 3.709472879176598*^9}, 3.709472916612238*^9, 
   3.710450010953497*^9, 3.710798447495652*^9, 3.710798748415504*^9, 
   3.710799130191766*^9, 3.710799602121932*^9, 3.7107997513319807`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ri", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1.0"}], ",", 
       RowBox[{"-", "0.447213595499957939281834733746"}], ",", 
       "0.447213595499957939281834733746", ",", "1.0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1.0"}], ",", " ", 
       RowBox[{"-", "0.654653670707977143798292456247"}], ",", " ", "0.0", 
       ",", " ", "0.654653670707977143798292456247", ",", " ", "1.0"}], 
      "}"}]}], "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"These", " ", "are", " ", "the", " ", "1"}], "-", 
    RowBox[{"d", " ", "lagrange", " ", "functions"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.707310057832816*^9, 3.7073100578336678`*^9}, {
   3.7073109586080027`*^9, 3.707310984929216*^9}, {3.7073110478427067`*^9, 
   3.707311100210928*^9}, {3.707325900754837*^9, 3.707325902803124*^9}, {
   3.707326022813806*^9, 3.707326054357506*^9}, {3.707326107835915*^9, 
   3.707326143039481*^9}, {3.707327861597055*^9, 3.7073278812300386`*^9}, 
   3.707327921343397*^9, {3.707327997904014*^9, 3.7073280044482203`*^9}, {
   3.707328054464527*^9, 3.70732806785701*^9}, {3.7073281535214787`*^9, 
   3.707328242194777*^9}, {3.707328629592169*^9, 3.7073286898823147`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"L", "[", 
    RowBox[{"r_", ",", "j_", ",", "d_"}], "]"}], ":=", 
   RowBox[{"Product", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"j", "\[NotEqual]", "k"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"r", "-", 
          RowBox[{
           RowBox[{"ri", "[", 
            RowBox[{"[", "d", "]"}], "]"}], "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"ri", "[", 
            RowBox[{"[", "d", "]"}], "]"}], "[", 
           RowBox[{"[", "j", "]"}], "]"}], "-", 
          RowBox[{
           RowBox[{"ri", "[", 
            RowBox[{"[", "d", "]"}], "]"}], "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], ")"}]}], ",", "1"}], "]"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"d", "+", "1"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.707326147542263*^9, 3.707326159126815*^9}, {
   3.7073273562154913`*^9, 3.707327372807448*^9}, {3.7073274204244833`*^9, 
   3.707327424312406*^9}, {3.707327565836687*^9, 3.707327612027142*^9}, {
   3.707328509239647*^9, 3.707328554088244*^9}, 3.7073287568430653`*^9, 
   3.70732879241114*^9, 3.7074079370618153`*^9, 3.709304708631563*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"index", " ", "starts", " ", "at", " ", "1"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ind2sub3dbeginat1i", "[", 
      RowBox[{"index_", ",", "nx_", ",", "ny_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"IntegerPart", "[", 
       RowBox[{"Mod", "[", 
        RowBox[{"index", ",", "nx"}], "]"}], "]"}], "+", "1"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ind2sub3dbeginat1j", "[", 
      RowBox[{"index_", ",", "nx_", ",", "ny_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"IntegerPart", "[", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"index", "-", 
            RowBox[{"Mod", "[", 
             RowBox[{"index", ",", "nx"}], "]"}]}], ")"}], "/", "nx"}], ",", 
         "ny"}], "]"}], "]"}], "+", "1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ind2sub3dbeginat1k", "[", 
      RowBox[{"index_", ",", "nx_", ",", "ny_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"IntegerPart", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"index", "-", 
              RowBox[{"Mod", "[", 
               RowBox[{"index", ",", "nx"}], "]"}]}], ")"}], "/", "nx"}], 
           ")"}], "-", 
          RowBox[{"IntegerPart", "[", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"index", "-", 
                RowBox[{"Mod", "[", 
                 RowBox[{"index", ",", "nx"}], "]"}]}], ")"}], "/", "nx"}], 
             ",", "ny"}], "]"}], "]"}], "+", "1"}], ")"}], "/", "ny"}], "]"}],
       "+", "1"}]}], " ", ";"}]}]}]], "Input",
 CellChangeTimes->{{3.709176540015778*^9, 3.709176559100369*^9}, {
   3.709176589102105*^9, 3.7091765924493437`*^9}, {3.7091766735334253`*^9, 
   3.709176689246414*^9}, {3.7091767364087*^9, 3.709176740769183*^9}, {
   3.709177453683412*^9, 3.709177461435749*^9}, 3.7091780113898773`*^9, {
   3.709178152914001*^9, 3.709178153134205*^9}, {3.709305691292486*^9, 
   3.709305721800126*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"ind", " ", "must", " ", "be", " ", "1", " ", "to", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"degree", "+", "1"}], ")"}], "^", "DIM"}], " ", "inclusive"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7099111042036448`*^9, 3.709911104651534*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"L3D", "[", 
    RowBox[{"r_", ",", "s_", ",", "t_", ",", "ind_", ",", "deg_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"L", "[", 
     RowBox[{"r", ",", 
      RowBox[{"ind2sub3dbeginat1i", "[", 
       RowBox[{
        RowBox[{"ind", "-", "1"}], ",", 
        RowBox[{"deg", "+", "1"}], ",", 
        RowBox[{"deg", "+", "1"}]}], "]"}], ",", "deg"}], "]"}], "*", 
    RowBox[{"L", "[", 
     RowBox[{"s", ",", 
      RowBox[{"ind2sub3dbeginat1j", "[", 
       RowBox[{
        RowBox[{"ind", "-", "1"}], ",", 
        RowBox[{"deg", "+", "1"}], ",", 
        RowBox[{"deg", "+", "1"}]}], "]"}], ",", "deg"}], "]"}], "*", 
    RowBox[{"L", "[", 
     RowBox[{"t", ",", 
      RowBox[{"ind2sub3dbeginat1k", "[", 
       RowBox[{
        RowBox[{"ind", "-", "1"}], ",", 
        RowBox[{"deg", "+", "1"}], ",", 
        RowBox[{"deg", "+", "1"}]}], "]"}], ",", "deg"}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.707440876277958*^9, 3.707440893259104*^9}, {
   3.7074409351844177`*^9, 3.707440935976426*^9}, {3.707441052835088*^9, 
   3.707441077835785*^9}, {3.709176398662876*^9, 3.7091764356559963`*^9}, {
   3.709176475621292*^9, 3.709176489357704*^9}, {3.709176564894557*^9, 
   3.709176571880023*^9}, {3.709176606388544*^9, 3.709176618110179*^9}, {
   3.709178066131122*^9, 3.709178111248446*^9}, {3.709178162451583*^9, 
   3.7091781888643093`*^9}, 3.709179190729958*^9, 3.70930572853118*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DL3D", "[", 
   RowBox[{
   "r_", ",", "s_", ",", "t_", ",", "ind_", ",", "deg_", ",", "dir_"}], "]"}],
   ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"drdx", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "dir", "]"}], "]"}], "*", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"L3D", "[", 
      RowBox[{"r", ",", "s", ",", "t", ",", "ind", ",", "deg"}], "]"}], ",", 
     "r"}], "]"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"+", 
       RowBox[{
        RowBox[{"drdx", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "dir", "]"}], "]"}]}], "*", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"L3D", "[", 
         RowBox[{"r", ",", "s", ",", "t", ",", "ind", ",", "deg"}], "]"}], 
        ",", "s"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{
       RowBox[{"drdx", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "[", 
       RowBox[{"[", "dir", "]"}], "]"}], "*", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"L3D", "[", 
         RowBox[{"r", ",", "s", ",", "t", ",", "ind", ",", "deg"}], "]"}], 
        ",", "t"}], "]"}]}]}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.710797855288845*^9, 3.7107978709608383`*^9}, {
   3.710798084424645*^9, 3.710798144747293*^9}, {3.710798352081924*^9, 
   3.710798423428553*^9}, {3.710798709455572*^9, 3.710798716478549*^9}, {
   3.710798799650082*^9, 3.710798819441681*^9}, 3.710799545273836*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DL3D", "[", 
  RowBox[{"r", ",", "s", ",", "t", ",", "1", ",", "1", ",", "1"}], 
  "]"}]], "Input"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.7108000132141867`*^9}]
}, Open  ]]
},
WindowSize->{1920, 1080},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.0 for Linux x86 (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[400, 13, 1525, 45, 107, "Input"],
Cell[1928, 60, 1177, 36, 83, "Input"],
Cell[3108, 98, 517, 16, 33, "Input"],
Cell[3628, 116, 1930, 58, 143, "Input"],
Cell[5561, 176, 1736, 53, 91, "Input"],
Cell[7300, 231, 5041, 160, 92, "Input"],
Cell[CellGroupData[{
Cell[12366, 395, 8567, 199, 275, "Input"],
Cell[CellGroupData[{
Cell[20958, 598, 707, 11, 43, "Print"],
Cell[21668, 611, 741, 12, 43, "Print"],
Cell[22412, 625, 545, 8, 43, "Print"],
Cell[22960, 635, 741, 12, 43, "Print"],
Cell[23704, 649, 707, 11, 43, "Print"],
Cell[24414, 662, 545, 8, 43, "Print"],
Cell[24962, 672, 692, 11, 43, "Print"],
Cell[25657, 685, 692, 11, 43, "Print"],
Cell[26352, 698, 494, 7, 24, "Print"]
}, Open  ]],
Cell[26861, 708, 752, 11, 52, "Output"],
Cell[CellGroupData[{
Cell[27638, 723, 633, 9, 43, "Print"],
Cell[28274, 734, 337, 5, 24, "Print"],
Cell[28614, 741, 624, 9, 43, "Print"],
Cell[29241, 752, 337, 5, 24, "Print"],
Cell[29581, 759, 631, 9, 43, "Print"],
Cell[30215, 770, 622, 9, 43, "Print"],
Cell[30840, 781, 544, 8, 43, "Print"],
Cell[31387, 791, 542, 8, 43, "Print"],
Cell[31932, 801, 493, 7, 24, "Print"],
Cell[32428, 810, 670, 10, 43, "Print"],
Cell[33101, 822, 347, 5, 24, "Print"],
Cell[33451, 829, 720, 11, 43, "Print"],
Cell[34174, 842, 349, 5, 24, "Print"],
Cell[34526, 849, 670, 10, 43, "Print"],
Cell[35199, 861, 720, 11, 43, "Print"],
Cell[35922, 874, 790, 12, 62, "Print"],
Cell[36715, 888, 789, 12, 62, "Print"],
Cell[37507, 902, 743, 11, 43, "Print"],
Cell[38253, 915, 585, 8, 43, "Print"],
Cell[38841, 925, 592, 9, 43, "Print"],
Cell[39436, 936, 337, 5, 24, "Print"],
Cell[39776, 943, 592, 9, 43, "Print"],
Cell[40371, 954, 587, 8, 43, "Print"],
Cell[40961, 964, 337, 5, 24, "Print"],
Cell[41301, 971, 337, 5, 24, "Print"],
Cell[41641, 978, 339, 5, 24, "Print"],
Cell[41983, 985, 758, 11, 62, "Print"],
Cell[42744, 998, 633, 9, 43, "Print"],
Cell[43380, 1009, 339, 5, 24, "Print"],
Cell[43722, 1016, 622, 9, 43, "Print"],
Cell[44347, 1027, 337, 5, 24, "Print"],
Cell[44687, 1034, 630, 9, 43, "Print"],
Cell[45320, 1045, 624, 9, 43, "Print"],
Cell[45947, 1056, 542, 8, 43, "Print"],
Cell[46492, 1066, 542, 8, 43, "Print"],
Cell[47037, 1076, 491, 7, 24, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[47577, 1089, 730, 20, 54, "Input"],
Cell[48310, 1111, 742, 20, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49089, 1136, 355, 7, 32, "Input"],
Cell[49447, 1145, 863, 22, 53, "Output"]
}, Open  ]],
Cell[50325, 1170, 1634, 36, 152, "Input"],
Cell[51962, 1208, 1313, 35, 35, "Input"],
Cell[53278, 1245, 2222, 60, 104, "Input"],
Cell[55503, 1307, 292, 7, 32, "Input"],
Cell[55798, 1316, 1451, 34, 35, "Input"],
Cell[57252, 1352, 1468, 42, 35, "Input"],
Cell[CellGroupData[{
Cell[58745, 1398, 123, 3, 32, "Input"],
Cell[58871, 1403, 79, 1, 30, "Output"]
}, Open  ]]
}
]
*)

