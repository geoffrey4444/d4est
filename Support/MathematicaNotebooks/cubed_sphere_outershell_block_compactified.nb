(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[     47008,       1135]
NotebookOptionsPosition[     44241,       1051]
NotebookOutlinePosition[     44575,       1066]
CellTagsIndexPosition[     44532,       1063]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"[", 
      RowBox[{"amin", ",", "amax"}], "]"}], " ", "are", " ", "the", " ", 
     "x"}], "-", 
    RowBox[{
    "corners", " ", "of", " ", "the", " ", "element", " ", "in", " ", "the", 
     " ", "topological", " ", 
     RowBox[{"space", " ", "[", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "]"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"[", 
      RowBox[{"bmin", ",", "bmax"}], "]"}], " ", "are", " ", "the", " ", 
     "x"}], "-", 
    RowBox[{
    "corners", " ", "of", " ", "the", " ", "element", " ", "in", " ", "the", 
     " ", "topological", " ", 
     RowBox[{"space", " ", "[", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "]"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"[", 
      RowBox[{"cmin", ",", "cmax"}], "]"}], " ", "are", " ", "the", " ", 
     "x"}], "-", 
    RowBox[{
    "corners", " ", "of", " ", "the", " ", "element", " ", "in", " ", "the", 
     " ", "topological", " ", 
     RowBox[{"space", " ", "[", 
      RowBox[{"1", ",", "2"}], "]"}]}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.699546556880673*^9, 3.699546556881516*^9}, 
   3.699546668068795*^9, 3.699549373231655*^9, {3.6995503190582447`*^9, 
   3.6995503192881403`*^9}, {3.700095485842636*^9, 3.700095486120947*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", "r_", "]"}], ":=", " ", 
   RowBox[{"amin", " ", "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"amax", "-", "amin"}], ")"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"r", "+", "1"}], ")"}], "/", "2"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b", "[", "s_", "]"}], ":=", 
   RowBox[{"bmin", " ", "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"bmax", "-", "bmin"}], ")"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"s", "+", "1"}], ")"}], "/", "2"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"c", "[", "t_", "]"}], ":=", 
   RowBox[{"cmin", " ", "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"cmax", "-", "cmin"}], ")"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"t", "+", "1"}], ")"}], "/", "2"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6995419796783953`*^9, 3.699542033818336*^9}, {
  3.699544419647629*^9, 3.699544421151099*^9}, {3.6995480954441853`*^9, 
  3.699548098390929*^9}, {3.6995481289073153`*^9, 3.6995481427235518`*^9}, {
  3.7001697034082823`*^9, 3.700169703639824*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", "-", "1"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "R2"}], ")"}], "-", 
      RowBox[{"(", 
       RowBox[{"1", "/", "R1"}], ")"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"n", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"1", "*", "R1"}], "-", 
      RowBox[{"2", "*", "R2"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"R1", "-", "R2"}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"R", "[", "t_", "]"}], "=", 
   RowBox[{"m", "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", "[", "t", "]"}], "-", "n"}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6995499106649313`*^9, 3.699549922115634*^9}, {
  3.6995502081074123`*^9, 3.6995502853676147`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"x", "[", "r_", "]"}], ":=", 
   RowBox[{"Tan", " ", "[", 
    RowBox[{
     RowBox[{"a", "[", "r", "]"}], "*", 
     RowBox[{"\[Pi]", "/", "4"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"y", "[", "s_", "]"}], ":=", 
   RowBox[{"Tan", " ", "[", 
    RowBox[{
     RowBox[{"b", "[", "s", "]"}], "*", 
     RowBox[{"\[Pi]", "/", "4"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"q", "[", 
    RowBox[{"r_", ",", "s_", ",", "t_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"R", "[", "t", "]"}], "/", 
    RowBox[{"Sqrt", " ", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "r", "]"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"y", "[", "s", "]"}], "^", "2"}], "+", "1"}], "]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"xf", "[", 
    RowBox[{"r_", ",", "s_", ",", "t_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"+", 
     RowBox[{"q", "[", 
      RowBox[{"r", ",", "s", ",", "t"}], "]"}]}], "*", 
    RowBox[{"x", "[", "r", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"yf", "[", 
    RowBox[{"r_", ",", "s_", ",", "t_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"+", 
     RowBox[{"q", "[", 
      RowBox[{"r", ",", "s", ",", "t"}], "]"}]}], "*", 
    RowBox[{"y", "[", "s", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zf", "[", 
    RowBox[{"r_", ",", "s_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"+", 
    RowBox[{"q", "[", 
     RowBox[{"r", ",", "s", ",", "t"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.69954197218334*^9, 3.699541972184321*^9}, {
  3.699542129577129*^9, 3.699542220945642*^9}, {3.699543118381762*^9, 
  3.6995434063743362`*^9}, {3.699543816973815*^9, 3.699543824968581*^9}, {
  3.6995438748435307`*^9, 3.699543883914052*^9}, {3.699544413357587*^9, 
  3.699544418654728*^9}, {3.699546573829671*^9, 3.69954667122686*^9}, {
  3.6995503849857693`*^9, 3.699550387200135*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xr", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"xf", "[", 
      RowBox[{"r", ",", "s", ",", "t"}], "]"}], ",", "r"}], "]"}]}], ";", " ", 
  RowBox[{"xs", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"xf", "[", 
      RowBox[{"r", ",", "s", ",", "t"}], "]"}], ",", "s"}], "]"}]}], ";", " ", 
  RowBox[{"xt", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"xf", "[", 
      RowBox[{"r", ",", "s", ",", "t"}], "]"}], ",", "t"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yr", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"yf", "[", 
      RowBox[{"r", ",", "s", ",", "t"}], "]"}], ",", "r"}], "]"}]}], ";", " ", 
  RowBox[{"ys", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"yf", "[", 
      RowBox[{"r", ",", "s", ",", "t"}], "]"}], ",", "s"}], "]"}]}], ";", " ", 
  RowBox[{"yt", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"yf", "[", 
      RowBox[{"r", ",", "s", ",", "t"}], "]"}], ",", "t"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zr", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"zf", "[", 
      RowBox[{"r", ",", "s", ",", "t"}], "]"}], ",", "r"}], "]"}]}], ";", 
  "  ", 
  RowBox[{"zs", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"zf", "[", 
      RowBox[{"r", ",", "s", ",", "t"}], "]"}], ",", "s"}], "]"}]}], ";", 
  RowBox[{"zt", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"zf", "[", 
      RowBox[{"r", ",", "s", ",", "t"}], "]"}], ",", "t"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.702779513987832*^9, 3.702779518237679*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dxdr", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xr", ",", "xs", ",", "xt"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"yr", ",", "ys", ",", "yt"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"zr", ",", "zs", ",", "zt"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J", " ", "=", " ", 
   RowBox[{
    RowBox[{"xr", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ys", "*", "zt"}], "-", 
       RowBox[{"zs", "*", "yt"}]}], ")"}]}], "-", 
    RowBox[{"yr", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"xs", "*", "zt"}], "-", 
       RowBox[{"zs", "*", "xt"}]}], ")"}]}], "+", 
    RowBox[{"zr", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"xs", "*", "yt"}], "-", 
       RowBox[{"ys", "*", "xt"}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drdx", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ys", "*", "zt"}], "-", 
          RowBox[{"zs", "*", "yt"}]}], ")"}], "/", 
        RowBox[{"(", "J", ")"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"xs", "*", "zt"}], "-", 
           RowBox[{"zs", "*", "xt"}]}], ")"}]}], "/", 
        RowBox[{"(", "J", ")"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"xs", "*", "yt"}], "-", 
          RowBox[{"ys", "*", "xt"}]}], ")"}], "/", 
        RowBox[{"(", "J", ")"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"yr", "*", "zt"}], "-", 
           RowBox[{"zr", "*", "yt"}]}], ")"}]}], "/", 
        RowBox[{"(", "J", ")"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"xr", "*", "zt"}], "-", 
          RowBox[{"zr", "*", "xt"}]}], ")"}], "/", 
        RowBox[{"(", "J", ")"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"xr", "*", "yt"}], "-", 
           RowBox[{"yr", "*", "xt"}]}], ")"}]}], "/", 
        RowBox[{"(", "J", ")"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"yr", "*", "zs"}], "-", 
          RowBox[{"zr", "*", "ys"}]}], ")"}], "/", 
        RowBox[{"(", "J", ")"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"xr", "*", "zs"}], "-", 
           RowBox[{"zr", "*", "xs"}]}], ")"}]}], "/", 
        RowBox[{"(", "J", ")"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"xr", "*", "ys"}], "-", 
          RowBox[{"yr", "*", "xs"}]}], ")"}], "/", 
        RowBox[{"(", "J", ")"}]}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drdxJ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ys", "*", "zt"}], "-", 
         RowBox[{"zs", "*", "yt"}]}], ")"}], ",", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"xs", "*", "zt"}], "-", 
          RowBox[{"zs", "*", "xt"}]}], ")"}]}], ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xs", "*", "yt"}], "-", 
         RowBox[{"ys", "*", "xt"}]}], ")"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"yr", "*", "zt"}], "-", 
          RowBox[{"zr", "*", "yt"}]}], ")"}]}], ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xr", "*", "zt"}], "-", 
         RowBox[{"zr", "*", "xt"}]}], ")"}], ",", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"xr", "*", "yt"}], "-", 
          RowBox[{"yr", "*", "xt"}]}], ")"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"yr", "*", "zs"}], "-", 
         RowBox[{"zr", "*", "ys"}]}], ")"}], ",", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"xr", "*", "zs"}], "-", 
          RowBox[{"zr", "*", "xs"}]}], ")"}]}], ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xr", "*", "ys"}], "-", 
         RowBox[{"yr", "*", "xs"}]}], ")"}]}], "}"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.702767921136414*^9, 3.702767972559712*^9}, {
   3.702768004826379*^9, 3.702768015603003*^9}, 3.702768077269484*^9, {
   3.702777238064062*^9, 3.7027773244753647`*^9}, {3.702778082050069*^9, 
   3.702778087077029*^9}, {3.702778327875937*^9, 3.702778374874288*^9}, {
   3.70277920718671*^9, 3.702779225061974*^9}, {3.702779361193205*^9, 
   3.702779377904117*^9}, {3.702920650314446*^9, 3.702920718604086*^9}, 
   3.7029433810049067`*^9, 3.706431824879335*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<dxyz_drst[\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"i", "-", "1"}], "]"}], ",", "\"\<][\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"j", "-", "1"}], "]"}], ",", "\"\<] = \>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"CForm", "[", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"dxdr", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "]"}], ",", 
        "\"\<;\>\""}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", " ", 
        RowBox[{"\"\<Pi\>\"", "\[Rule]", "\"\<M_PI\>\""}], ",", 
        RowBox[{"\"\<Sin\>\"", "\[Rule]", "\"\<sin\>\""}], ",", 
        RowBox[{"\"\<Cos\>\"", "\[Rule]", "\"\<cos\>\""}], ",", 
        RowBox[{"\"\<Tan\>\"", "\[Rule]", "\"\<tan\>\""}], ",", 
        RowBox[{"\"\<Sqrt\>\"", "->", "\"\<sqrt\>\""}], ",", 
        RowBox[{"\"\<Sec\>\"", "\[Rule]", "\"\<secant_fcn\>\""}]}], "}"}]}], 
     "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<jacobian = \>\"", ",", 
     RowBox[{"ToString", "[", 
      RowBox[{"CForm", "[", 
       RowBox[{"Simplify", "[", "J", "]"}], "]"}], " ", "]"}], " ", ",", " ", 
     "\"\<;\>\""}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", " ", 
     RowBox[{"\"\<Pi\>\"", "\[Rule]", "\"\<M_PI\>\""}], ",", 
     RowBox[{"\"\<Sin\>\"", "\[Rule]", "\"\<sin\>\""}], ",", 
     RowBox[{"\"\<Cos\>\"", "\[Rule]", "\"\<cos\>\""}], ",", 
     RowBox[{"\"\<Tan\>\"", "\[Rule]", "\"\<tan\>\""}], ",", 
     RowBox[{"\"\<Sqrt\>\"", "->", "\"\<sqrt\>\""}], ",", 
     RowBox[{"\"\<Sec\>\"", "\[Rule]", "\"\<secant_fcn\>\""}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<drst_dxyz[\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"i", "-", "1"}], "]"}], ",", "\"\<][\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"j", "-", "1"}], "]"}], ",", "\"\<] = \>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"CForm", "[", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"drdx", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "]"}], ",", 
        "\"\<;\>\""}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", " ", 
        RowBox[{"\"\<Pi\>\"", "\[Rule]", "\"\<M_PI\>\""}], ",", 
        RowBox[{"\"\<Sin\>\"", "\[Rule]", "\"\<sin\>\""}], ",", 
        RowBox[{"\"\<Cos\>\"", "\[Rule]", "\"\<cos\>\""}], ",", 
        RowBox[{"\"\<Tan\>\"", "\[Rule]", "\"\<tan\>\""}], ",", 
        RowBox[{"\"\<Sqrt\>\"", "->", "\"\<sqrt\>\""}], ",", 
        RowBox[{"\"\<Sec\>\"", "\[Rule]", "\"\<secant_fcn\>\""}]}], "}"}]}], 
     "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<drst_dxyz_times_jac[\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"i", "-", "1"}], "]"}], ",", "\"\<][\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"j", "-", "1"}], "]"}], ",", "\"\<] = \>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"CForm", "[", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"drdxJ", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "]"}], ",", 
        "\"\<;\>\""}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", " ", 
        RowBox[{"\"\<Pi\>\"", "\[Rule]", "\"\<M_PI\>\""}], ",", 
        RowBox[{"\"\<Sin\>\"", "\[Rule]", "\"\<sin\>\""}], ",", 
        RowBox[{"\"\<Cos\>\"", "\[Rule]", "\"\<cos\>\""}], ",", 
        RowBox[{"\"\<Tan\>\"", "\[Rule]", "\"\<tan\>\""}], ",", 
        RowBox[{"\"\<Sqrt\>\"", "->", "\"\<sqrt\>\""}], ",", 
        RowBox[{"\"\<Sec\>\"", "\[Rule]", "\"\<secant_fcn\>\""}]}], "}"}]}], 
     "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<drdxJdrdx[\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"i", "-", "1"}], "]"}], ",", "\"\<][\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"j", "-", "1"}], "]"}], ",", "\"\<] = \>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"CForm", "[", 
          RowBox[{"Simplify", "[", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"drdxJ", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{
               RowBox[{"drdx", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}], "]"}],
          "]"}], ",", "\"\<;\>\""}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", " ", 
        RowBox[{"\"\<Pi\>\"", "\[Rule]", "\"\<M_PI\>\""}], ",", 
        RowBox[{"\"\<Sin\>\"", "\[Rule]", "\"\<sin\>\""}], ",", 
        RowBox[{"\"\<Cos\>\"", "\[Rule]", "\"\<cos\>\""}], ",", 
        RowBox[{"\"\<Tan\>\"", "\[Rule]", "\"\<tan\>\""}], ",", 
        RowBox[{"\"\<Sqrt\>\"", "->", "\"\<sqrt\>\""}], ",", 
        RowBox[{"\"\<Sec\>\"", "\[Rule]", "\"\<secant_fcn\>\""}]}], "}"}]}], 
     "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<drst_dxyz[\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"i", "-", "1"}], "]"}], ",", "\"\<][\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"j", "-", "1"}], "]"}], ",", "\"\<] = \>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"CForm", "[", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"drdx", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "]"}], ",", 
        "\"\<;\>\""}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", " ", 
        RowBox[{"\"\<Pi\>\"", "\[Rule]", "\"\<M_PI\>\""}], ",", 
        RowBox[{"\"\<Sin\>\"", "\[Rule]", "\"\<sin\>\""}], ",", 
        RowBox[{"\"\<Cos\>\"", "\[Rule]", "\"\<cos\>\""}], ",", 
        RowBox[{"\"\<Tan\>\"", "\[Rule]", "\"\<tan\>\""}], ",", 
        RowBox[{"\"\<Sqrt\>\"", "->", "\"\<sqrt\>\""}], ",", 
        RowBox[{"\"\<Sec\>\"", "\[Rule]", "\"\<secant_fcn\>\""}]}], "}"}]}], 
     "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<sj_sqr_vol[\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"i", "-", "1"}], "]"}], ",", "\"\<] = \>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"CForm", "[", 
          RowBox[{"Simplify", "[", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"drdxJ", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{
               RowBox[{"drdxJ", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}], "]"}],
          "]"}], ",", "\"\<;\>\""}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", " ", 
        RowBox[{"\"\<Pi\>\"", "\[Rule]", "\"\<M_PI\>\""}], ",", 
        RowBox[{"\"\<Sin\>\"", "\[Rule]", "\"\<sin\>\""}], ",", 
        RowBox[{"\"\<Cos\>\"", "\[Rule]", "\"\<cos\>\""}], ",", 
        RowBox[{"\"\<Tan\>\"", "\[Rule]", "\"\<tan\>\""}], ",", 
        RowBox[{"\"\<Sqrt\>\"", "->", "\"\<sqrt\>\""}], ",", 
        RowBox[{"\"\<Sec\>\"", "\[Rule]", "\"\<secant_fcn\>\""}]}], "}"}]}], 
     "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<sj_sqr_div_J_sqr_vol[\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"i", "-", "1"}], "]"}], ",", "\"\<] = \>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"CForm", "[", 
          RowBox[{"Simplify", "[", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"drdx", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{
               RowBox[{"drdx", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}], "]"}],
          "]"}], ",", "\"\<;\>\""}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", " ", 
        RowBox[{"\"\<Pi\>\"", "\[Rule]", "\"\<M_PI\>\""}], ",", 
        RowBox[{"\"\<Sin\>\"", "\[Rule]", "\"\<sin\>\""}], ",", 
        RowBox[{"\"\<Cos\>\"", "\[Rule]", "\"\<cos\>\""}], ",", 
        RowBox[{"\"\<Tan\>\"", "\[Rule]", "\"\<tan\>\""}], ",", 
        RowBox[{"\"\<Sqrt\>\"", "->", "\"\<sqrt\>\""}], ",", 
        RowBox[{"\"\<Sec\>\"", "\[Rule]", "\"\<secant_fcn\>\""}]}], "}"}]}], 
     "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.702778489546298*^9, 3.702778594954393*^9}, {
  3.702778625551796*^9, 3.702778626464368*^9}, {3.70277868394108*^9, 
  3.7027788308919477`*^9}, {3.702778901658266*^9, 3.702779035406241*^9}, {
  3.702779197247562*^9, 3.702779202315544*^9}, {3.7027795307489634`*^9, 
  3.7027795782886477`*^9}, {3.7027796984286203`*^9, 3.702779711578933*^9}, {
  3.702779743306527*^9, 3.70277981029527*^9}, {3.7028287944763308`*^9, 
  3.7028288114599447`*^9}, {3.702841379060328*^9, 3.702841380930273*^9}, {
  3.70386130848212*^9, 3.7038614255164413`*^9}, {3.703861546626275*^9, 
  3.7038615581185226`*^9}, {3.7038631598925343`*^9, 3.703863182520393*^9}, {
  3.704057107312101*^9, 3.7040571117985277`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"dxyz_drst[0][0] = ((amax - \
amin)*M_PI*R1*R2*pow(secant_fcn((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)*pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2))/(4.*(-(R2*(-4 + cmax + cmin + cmax*t - cmin*t)) + R1*(-2 + \
cmax + cmin + cmax*t - cmin*t))*pow(pow(secant_fcn((M_PI*(bmax + bmin + \
bmax*s - bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2),1.5));\"\>"], "Print",
 CellChangeTimes->{3.7064318550850677`*^9}],

Cell[BoxData["\<\"dxyz_drst[0][1] = -((bmax - \
bmin)*M_PI*R1*R2*pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2)*tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.)*tan((M_PI*(bmax + bmin + bmax*s - bmin*s))/8.))/(4.*(-(R2*(-4 + \
cmax + cmin + cmax*t - cmin*t)) + R1*(-2 + cmax + cmin + cmax*t - \
cmin*t))*pow(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - bmin*s))/8.),2) + \
pow(tan((M_PI*(amax + amin + amax*r - amin*r))/8.),2),1.5));\"\>"], "Print",
 CellChangeTimes->{3.706431855351821*^9}],

Cell[BoxData["\<\"dxyz_drst[0][2] = (-2*(cmax - cmin)*R1*(R1 - \
R2)*R2*tan((M_PI*(amax + amin + amax*r - amin*r))/8.))/(pow(R2*(-4 + cmax + \
cmin + cmax*t - cmin*t) - R1*(-2 + cmax + cmin + cmax*t - \
cmin*t),2)*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - bmin*s))/8.),2) \
+ pow(tan((M_PI*(amax + amin + amax*r - amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{3.7064318555457153`*^9}],

Cell[BoxData["\<\"dxyz_drst[1][0] = -((amax - \
amin)*M_PI*R1*R2*pow(secant_fcn((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)*tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.)*tan((M_PI*(bmax + bmin + bmax*s - bmin*s))/8.))/(4.*(-(R2*(-4 + \
cmax + cmin + cmax*t - cmin*t)) + R1*(-2 + cmax + cmin + cmax*t - \
cmin*t))*pow(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - bmin*s))/8.),2) + \
pow(tan((M_PI*(amax + amin + amax*r - amin*r))/8.),2),1.5));\"\>"], "Print",
 CellChangeTimes->{3.7064318558160057`*^9}],

Cell[BoxData["\<\"dxyz_drst[1][1] = ((bmax - \
bmin)*M_PI*R1*R2*pow(secant_fcn((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)*pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2))/(4.*(-(R2*(-4 + cmax + cmin + cmax*t - cmin*t)) + R1*(-2 + \
cmax + cmin + cmax*t - cmin*t))*pow(pow(secant_fcn((M_PI*(bmax + bmin + \
bmax*s - bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2),1.5));\"\>"], "Print",
 CellChangeTimes->{3.706431856021974*^9}],

Cell[BoxData["\<\"dxyz_drst[1][2] = (-2*(cmax - cmin)*R1*(R1 - \
R2)*R2*tan((M_PI*(bmax + bmin + bmax*s - bmin*s))/8.))/(pow(R2*(-4 + cmax + \
cmin + cmax*t - cmin*t) - R1*(-2 + cmax + cmin + cmax*t - \
cmin*t),2)*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - bmin*s))/8.),2) \
+ pow(tan((M_PI*(amax + amin + amax*r - amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{3.7064318561122828`*^9}],

Cell[BoxData["\<\"dxyz_drst[2][0] = -((amax - \
amin)*M_PI*R1*R2*pow(secant_fcn((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)*tan((M_PI*(amax + amin + amax*r - amin*r))/8.))/(4.*(-(R2*(-4 \
+ cmax + cmin + cmax*t - cmin*t)) + R1*(-2 + cmax + cmin + cmax*t - \
cmin*t))*pow(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - bmin*s))/8.),2) + \
pow(tan((M_PI*(amax + amin + amax*r - amin*r))/8.),2),1.5));\"\>"], "Print",
 CellChangeTimes->{3.7064318566250563`*^9}],

Cell[BoxData["\<\"dxyz_drst[2][1] = -((bmax - \
bmin)*M_PI*R1*R2*pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2)*tan((M_PI*(bmax + bmin + bmax*s - bmin*s))/8.))/(4.*(-(R2*(-4 \
+ cmax + cmin + cmax*t - cmin*t)) + R1*(-2 + cmax + cmin + cmax*t - \
cmin*t))*pow(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - bmin*s))/8.),2) + \
pow(tan((M_PI*(amax + amin + amax*r - amin*r))/8.),2),1.5));\"\>"], "Print",
 CellChangeTimes->{3.706431856626875*^9}],

Cell[BoxData["\<\"dxyz_drst[2][2] = (-2*(cmax - cmin)*R1*(R1 - \
R2)*R2)/(pow(R2*(-4 + cmax + cmin + cmax*t - cmin*t) - R1*(-2 + cmax + cmin + \
cmax*t - cmin*t),2)*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{3.706431856675619*^9}]
}, Open  ]],

Cell[BoxData["\<\"jacobian = -((amax - amin)*(bmax - bmin)*(cmax - \
cmin)*pow(M_PI,2)*pow(R1,3)*(R1 - R2)*pow(R2,3)*pow(secant_fcn((M_PI*(amax + \
amin + amax*r - amin*r))/8.),2)*pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2))/(8.*pow(R2*(-4 + cmax + cmin + cmax*t - cmin*t) - R1*(-2 + \
cmax + cmin + cmax*t - cmin*t),4)*pow(pow(secant_fcn((M_PI*(bmax + bmin + \
bmax*s - bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2),1.5));\"\>"], "Output",
 CellChangeTimes->{3.706431858227331*^9}],

Cell[CellGroupData[{

Cell[BoxData["\<\"drst_dxyz[0][0] = (4*(-(R2*(-4 + cmax + cmin + cmax*t - \
cmin*t)) + R1*(-2 + cmax + cmin + cmax*t - cmin*t))*pow(cos((M_PI*(amax + \
amin + amax*r - amin*r))/8.),2)*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + \
bmax*s - bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)))/((amax - amin)*M_PI*R1*R2);\"\>"], "Print",
 CellChangeTimes->{3.706431858385579*^9}],

Cell[BoxData["\<\"drst_dxyz[0][1] = 0;\"\>"], "Print",
 CellChangeTimes->{3.706431858387493*^9}],

Cell[BoxData["\<\"drst_dxyz[0][2] = (-2*(-(R2*(-4 + cmax + cmin + cmax*t - \
cmin*t)) + R1*(-2 + cmax + cmin + cmax*t - cmin*t))*sin((M_PI*(amax + amin + \
amax*r - amin*r))/4.)*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)))/((amax - amin)*M_PI*R1*R2);\"\>"], "Print",
 CellChangeTimes->{3.706431858560444*^9}],

Cell[BoxData["\<\"drst_dxyz[1][0] = 0;\"\>"], "Print",
 CellChangeTimes->{3.7064318585622272`*^9}],

Cell[BoxData["\<\"drst_dxyz[1][1] = (4*(-(R2*(-4 + cmax + cmin + cmax*t - \
cmin*t)) + R1*(-2 + cmax + cmin + cmax*t - cmin*t))*pow(cos((M_PI*(bmax + \
bmin + bmax*s - bmin*s))/8.),2)*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + \
bmax*s - bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)))/((bmax - bmin)*M_PI*R1*R2);\"\>"], "Print",
 CellChangeTimes->{3.706431858733284*^9}],

Cell[BoxData["\<\"drst_dxyz[1][2] = (-2*(-(R2*(-4 + cmax + cmin + cmax*t - \
cmin*t)) + R1*(-2 + cmax + cmin + cmax*t - cmin*t))*sin((M_PI*(bmax + bmin + \
bmax*s - bmin*s))/4.)*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)))/((bmax - bmin)*M_PI*R1*R2);\"\>"], "Print",
 CellChangeTimes->{3.706431858902873*^9}],

Cell[BoxData["\<\"drst_dxyz[2][0] = -(pow(R2*(-4 + cmax + cmin + cmax*t - \
cmin*t) - R1*(-2 + cmax + cmin + cmax*t - cmin*t),2)*tan((M_PI*(amax + amin + \
amax*r - amin*r))/8.))/(2.*(cmax - cmin)*R1*(R1 - \
R2)*R2*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - bmin*s))/8.),2) + \
pow(tan((M_PI*(amax + amin + amax*r - amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{3.706431859092576*^9}],

Cell[BoxData["\<\"drst_dxyz[2][1] = -(pow(R2*(-4 + cmax + cmin + cmax*t - \
cmin*t) - R1*(-2 + cmax + cmin + cmax*t - cmin*t),2)*tan((M_PI*(bmax + bmin + \
bmax*s - bmin*s))/8.))/(2.*(cmax - cmin)*R1*(R1 - \
R2)*R2*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - bmin*s))/8.),2) + \
pow(tan((M_PI*(amax + amin + amax*r - amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{3.7064318592646217`*^9}],

Cell[BoxData["\<\"drst_dxyz[2][2] = -pow(R2*(-4 + cmax + cmin + cmax*t - \
cmin*t) - R1*(-2 + cmax + cmin + cmax*t - cmin*t),2)/(2.*(cmax - cmin)*R1*(R1 \
- R2)*R2*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - bmin*s))/8.),2) + \
pow(tan((M_PI*(amax + amin + amax*r - amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{3.706431859434332*^9}],

Cell[BoxData["\<\"drst_dxyz_times_jac[0][0] = -((bmax - bmin)*(cmax - \
cmin)*M_PI*pow(R1,2)*(R1 - R2)*pow(R2,2)*pow(secant_fcn((M_PI*(bmax + bmin + \
bmax*s - bmin*s))/8.),2))/(2.*pow(-(R2*(-4 + cmax + cmin + cmax*t - cmin*t)) \
+ R1*(-2 + cmax + cmin + cmax*t - cmin*t),3)*(pow(secant_fcn((M_PI*(bmax + \
bmin + bmax*s - bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{3.706431859873507*^9}],

Cell[BoxData["\<\"drst_dxyz_times_jac[0][1] = 0;\"\>"], "Print",
 CellChangeTimes->{3.706431859875318*^9}],

Cell[BoxData["\<\"drst_dxyz_times_jac[0][2] = ((bmax - bmin)*(cmax - \
cmin)*M_PI*pow(R1,2)*(R1 - R2)*pow(R2,2)*pow(secant_fcn((M_PI*(bmax + bmin + \
bmax*s - bmin*s))/8.),2)*tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.))/(2.*pow(-(R2*(-4 + cmax + cmin + cmax*t - cmin*t)) + R1*(-2 + \
cmax + cmin + cmax*t - cmin*t),3)*(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s \
- bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{3.706431860197749*^9}],

Cell[BoxData["\<\"drst_dxyz_times_jac[1][0] = 0;\"\>"], "Print",
 CellChangeTimes->{3.706431860199897*^9}],

Cell[BoxData["\<\"drst_dxyz_times_jac[1][1] = -((amax - amin)*(cmax - \
cmin)*M_PI*pow(R1,2)*(R1 - R2)*pow(R2,2)*pow(secant_fcn((M_PI*(amax + amin + \
amax*r - amin*r))/8.),2))/(2.*pow(-(R2*(-4 + cmax + cmin + cmax*t - cmin*t)) \
+ R1*(-2 + cmax + cmin + cmax*t - cmin*t),3)*(pow(secant_fcn((M_PI*(bmax + \
bmin + bmax*s - bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{3.7064318603452168`*^9}],

Cell[BoxData["\<\"drst_dxyz_times_jac[1][2] = ((amax - amin)*(cmax - \
cmin)*M_PI*pow(R1,2)*(R1 - R2)*pow(R2,2)*pow(secant_fcn((M_PI*(amax + amin + \
amax*r - amin*r))/8.),2)*tan((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.))/(2.*pow(-(R2*(-4 + cmax + cmin + cmax*t - cmin*t)) + R1*(-2 + \
cmax + cmin + cmax*t - cmin*t),3)*(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s \
- bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{3.706431860582254*^9}],

Cell[BoxData["\<\"drst_dxyz_times_jac[2][0] = ((amax - amin)*(bmax - \
bmin)*pow(M_PI,2)*pow(R1,2)*pow(R2,2)*pow(secant_fcn((M_PI*(amax + amin + \
amax*r - amin*r))/8.),2)*pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2)*tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.))/(16.*pow(R2*(-4 + cmax + cmin + cmax*t - cmin*t) - R1*(-2 + \
cmax + cmin + cmax*t - cmin*t),2)*pow(pow(secant_fcn((M_PI*(bmax + bmin + \
bmax*s - bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2),2));\"\>"], "Print",
 CellChangeTimes->{3.706431861176601*^9}],

Cell[BoxData["\<\"drst_dxyz_times_jac[2][1] = ((amax - amin)*(bmax - \
bmin)*pow(M_PI,2)*pow(R1,2)*pow(R2,2)*pow(secant_fcn((M_PI*(amax + amin + \
amax*r - amin*r))/8.),2)*pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2)*tan((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.))/(16.*pow(R2*(-4 + cmax + cmin + cmax*t - cmin*t) - R1*(-2 + \
cmax + cmin + cmax*t - cmin*t),2)*pow(pow(secant_fcn((M_PI*(bmax + bmin + \
bmax*s - bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2),2));\"\>"], "Print",
 CellChangeTimes->{3.706431861385557*^9}],

Cell[BoxData["\<\"drst_dxyz_times_jac[2][2] = ((amax - amin)*(bmax - \
bmin)*pow(M_PI,2)*pow(R1,2)*pow(R2,2)*pow(secant_fcn((M_PI*(amax + amin + \
amax*r - amin*r))/8.),2)*pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2))/(16.*pow(R2*(-4 + cmax + cmin + cmax*t - cmin*t) - R1*(-2 + \
cmax + cmin + cmax*t - cmin*t),2)*pow(pow(secant_fcn((M_PI*(bmax + bmin + \
bmax*s - bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2),2));\"\>"], "Print",
 CellChangeTimes->{3.706431861965137*^9}],

Cell[BoxData["\<\"drdxJdrdx[0][0] = (-2*(bmax - bmin)*(cmax - cmin)*R1*(R1 - \
R2)*R2*pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - bmin*s))/8.),2))/((amax - \
amin)*pow(R2*(-4 + cmax + cmin + cmax*t - cmin*t) - R1*(-2 + cmax + cmin + \
cmax*t - cmin*t),2)*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{3.70643186223916*^9}],

Cell[BoxData["\<\"drdxJdrdx[0][1] = (-2*(cmax - cmin)*R1*(R1 - \
R2)*R2*tan((M_PI*(amax + amin + amax*r - amin*r))/8.)*tan((M_PI*(bmax + bmin \
+ bmax*s - bmin*s))/8.))/(pow(R2*(-4 + cmax + cmin + cmax*t - cmin*t) - \
R1*(-2 + cmax + cmin + cmax*t - cmin*t),2)*sqrt(pow(secant_fcn((M_PI*(bmax + \
bmin + bmax*s - bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{3.706431862455881*^9}],

Cell[BoxData["\<\"drdxJdrdx[0][2] = 0;\"\>"], "Print",
 CellChangeTimes->{3.706431862538896*^9}],

Cell[BoxData["\<\"drdxJdrdx[1][0] = (-2*(cmax - cmin)*R1*(R1 - \
R2)*R2*tan((M_PI*(amax + amin + amax*r - amin*r))/8.)*tan((M_PI*(bmax + bmin \
+ bmax*s - bmin*s))/8.))/(pow(R2*(-4 + cmax + cmin + cmax*t - cmin*t) - \
R1*(-2 + cmax + cmin + cmax*t - cmin*t),2)*sqrt(pow(secant_fcn((M_PI*(bmax + \
bmin + bmax*s - bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{3.706431862540023*^9}],

Cell[BoxData["\<\"drdxJdrdx[1][1] = (-2*(amax - amin)*(cmax - cmin)*R1*(R1 - \
R2)*R2*pow(secant_fcn((M_PI*(amax + amin + amax*r - amin*r))/8.),2))/((bmax - \
bmin)*pow(R2*(-4 + cmax + cmin + cmax*t - cmin*t) - R1*(-2 + cmax + cmin + \
cmax*t - cmin*t),2)*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{3.706431862823699*^9}],

Cell[BoxData["\<\"drdxJdrdx[1][2] = 0;\"\>"], "Print",
 CellChangeTimes->{3.7064318629208803`*^9}],

Cell[BoxData["\<\"drdxJdrdx[2][0] = 0;\"\>"], "Print",
 CellChangeTimes->{3.7064318629219923`*^9}],

Cell[BoxData["\<\"drdxJdrdx[2][1] = 0;\"\>"], "Print",
 CellChangeTimes->{3.7064318629228563`*^9}],

Cell[BoxData["\<\"drdxJdrdx[2][2] = -((amax - amin)*(bmax - \
bmin)*pow(M_PI,2)*R1*R2*pow(secant_fcn((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)*pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2))/(32.*(cmax - cmin)*(R1 - R2)*pow(pow(secant_fcn((M_PI*(bmax \
+ bmin + bmax*s - bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2),1.5));\"\>"], "Print",
 CellChangeTimes->{3.706431863747321*^9}],

Cell[BoxData["\<\"drst_dxyz[0][0] = (4*(-(R2*(-4 + cmax + cmin + cmax*t - \
cmin*t)) + R1*(-2 + cmax + cmin + cmax*t - cmin*t))*pow(cos((M_PI*(amax + \
amin + amax*r - amin*r))/8.),2)*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + \
bmax*s - bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)))/((amax - amin)*M_PI*R1*R2);\"\>"], "Print",
 CellChangeTimes->{3.706431863865301*^9}],

Cell[BoxData["\<\"drst_dxyz[0][1] = 0;\"\>"], "Print",
 CellChangeTimes->{3.706431863867115*^9}],

Cell[BoxData["\<\"drst_dxyz[0][2] = (-2*(-(R2*(-4 + cmax + cmin + cmax*t - \
cmin*t)) + R1*(-2 + cmax + cmin + cmax*t - cmin*t))*sin((M_PI*(amax + amin + \
amax*r - amin*r))/4.)*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)))/((amax - amin)*M_PI*R1*R2);\"\>"], "Print",
 CellChangeTimes->{3.706431863974861*^9}],

Cell[BoxData["\<\"drst_dxyz[1][0] = 0;\"\>"], "Print",
 CellChangeTimes->{3.706431863976698*^9}],

Cell[BoxData["\<\"drst_dxyz[1][1] = (4*(-(R2*(-4 + cmax + cmin + cmax*t - \
cmin*t)) + R1*(-2 + cmax + cmin + cmax*t - cmin*t))*pow(cos((M_PI*(bmax + \
bmin + bmax*s - bmin*s))/8.),2)*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + \
bmax*s - bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)))/((bmax - bmin)*M_PI*R1*R2);\"\>"], "Print",
 CellChangeTimes->{3.7064318640920057`*^9}],

Cell[BoxData["\<\"drst_dxyz[1][2] = (-2*(-(R2*(-4 + cmax + cmin + cmax*t - \
cmin*t)) + R1*(-2 + cmax + cmin + cmax*t - cmin*t))*sin((M_PI*(bmax + bmin + \
bmax*s - bmin*s))/4.)*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)))/((bmax - bmin)*M_PI*R1*R2);\"\>"], "Print",
 CellChangeTimes->{3.706431864229392*^9}],

Cell[BoxData["\<\"drst_dxyz[2][0] = -(pow(R2*(-4 + cmax + cmin + cmax*t - \
cmin*t) - R1*(-2 + cmax + cmin + cmax*t - cmin*t),2)*tan((M_PI*(amax + amin + \
amax*r - amin*r))/8.))/(2.*(cmax - cmin)*R1*(R1 - \
R2)*R2*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - bmin*s))/8.),2) + \
pow(tan((M_PI*(amax + amin + amax*r - amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{3.706431864231217*^9}],

Cell[BoxData["\<\"drst_dxyz[2][1] = -(pow(R2*(-4 + cmax + cmin + cmax*t - \
cmin*t) - R1*(-2 + cmax + cmin + cmax*t - cmin*t),2)*tan((M_PI*(bmax + bmin + \
bmax*s - bmin*s))/8.))/(2.*(cmax - cmin)*R1*(R1 - \
R2)*R2*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - bmin*s))/8.),2) + \
pow(tan((M_PI*(amax + amin + amax*r - amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{3.706431864387537*^9}],

Cell[BoxData["\<\"drst_dxyz[2][2] = -pow(R2*(-4 + cmax + cmin + cmax*t - \
cmin*t) - R1*(-2 + cmax + cmin + cmax*t - cmin*t),2)/(2.*(cmax - cmin)*R1*(R1 \
- R2)*R2*sqrt(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - bmin*s))/8.),2) + \
pow(tan((M_PI*(amax + amin + amax*r - amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{3.706431864499543*^9}],

Cell[BoxData["\<\"sj_sqr_vol[0] = (pow(bmax - bmin,2)*pow(cmax - \
cmin,2)*pow(M_PI,2)*pow(R1,4)*pow(R1 - \
R2,2)*pow(R2,4)*pow(secant_fcn((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)*pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),4))/(4.*pow(R2*(-4 + cmax + cmin + cmax*t - cmin*t) - R1*(-2 + \
cmax + cmin + cmax*t - cmin*t),6)*pow(pow(secant_fcn((M_PI*(bmax + bmin + \
bmax*s - bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2),2));\"\>"], "Print",
 CellChangeTimes->{3.7064318733275957`*^9}],

Cell[BoxData["\<\"sj_sqr_vol[1] = (pow(amax - amin,2)*pow(cmax - \
cmin,2)*pow(M_PI,2)*pow(R1,4)*pow(R1 - \
R2,2)*pow(R2,4)*pow(secant_fcn((M_PI*(amax + amin + amax*r - \
amin*r))/8.),4)*pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),2))/(4.*pow(R2*(-4 + cmax + cmin + cmax*t - cmin*t) - R1*(-2 + \
cmax + cmin + cmax*t - cmin*t),6)*pow(pow(secant_fcn((M_PI*(bmax + bmin + \
bmax*s - bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2),2));\"\>"], "Print",
 CellChangeTimes->{3.706431881661471*^9}],

Cell[BoxData["\<\"sj_sqr_vol[2] = (pow(amax - amin,2)*pow(bmax - \
bmin,2)*pow(M_PI,4)*pow(R1,4)*pow(R2,4)*pow(secant_fcn((M_PI*(amax + amin + \
amax*r - amin*r))/8.),4)*pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - \
bmin*s))/8.),4))/(256.*pow(R2*(-4 + cmax + cmin + cmax*t - cmin*t) - R1*(-2 + \
cmax + cmin + cmax*t - cmin*t),4)*pow(pow(secant_fcn((M_PI*(bmax + bmin + \
bmax*s - bmin*s))/8.),2) + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2),3));\"\>"], "Print",
 CellChangeTimes->{3.706431959198954*^9}],

Cell[BoxData["\<\"sj_sqr_div_J_sqr_vol[0] = (16*pow(R2*(-4 + cmax + cmin + \
cmax*t - cmin*t) - R1*(-2 + cmax + cmin + cmax*t - \
cmin*t),2)*pow(cos((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)*(pow(secant_fcn((M_PI*(bmax + bmin + bmax*s - bmin*s))/8.),2) \
+ pow(tan((M_PI*(amax + amin + amax*r - amin*r))/8.),2)))/(pow(amax - \
amin,2)*pow(M_PI,2)*pow(R1,2)*pow(R2,2));\"\>"], "Print",
 CellChangeTimes->{3.706431959431259*^9}],

Cell[BoxData["\<\"sj_sqr_div_J_sqr_vol[1] = (16*pow(R2*(-4 + cmax + cmin + \
cmax*t - cmin*t) - R1*(-2 + cmax + cmin + cmax*t - cmin*t),2)*(1 + \
pow(cos((M_PI*(bmax + bmin + bmax*s - bmin*s))/8.),2)*pow(tan((M_PI*(amax + \
amin + amax*r - amin*r))/8.),2)))/(pow(bmax - \
bmin,2)*pow(M_PI,2)*pow(R1,2)*pow(R2,2));\"\>"], "Print",
 CellChangeTimes->{3.7064319596620092`*^9}],

Cell[BoxData["\<\"sj_sqr_div_J_sqr_vol[2] = pow(R2*(-4 + cmax + cmin + cmax*t \
- cmin*t) - R1*(-2 + cmax + cmin + cmax*t - cmin*t),4)/(4.*pow(cmax - \
cmin,2)*pow(R1,2)*pow(R1 - R2,2)*pow(R2,2));\"\>"], "Print",
 CellChangeTimes->{3.706431959795415*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{476, 1161},
WindowMargins->{{Automatic, 2}, {Automatic, 18}},
FrontEndVersion->"11.0 for Linux x86 (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[400, 13, 1553, 45, 107, "Input"],
Cell[1956, 60, 1184, 36, 83, "Input"],
Cell[3143, 98, 851, 29, 74, "Input"],
Cell[3997, 129, 1932, 58, 143, "Input"],
Cell[5932, 189, 1736, 53, 91, "Input"],
Cell[7671, 244, 4944, 156, 92, "Input"],
Cell[CellGroupData[{
Cell[12640, 404, 11929, 278, 371, "Input"],
Cell[CellGroupData[{
Cell[24594, 686, 475, 7, 226, "Print"],
Cell[25072, 695, 507, 7, 243, "Print"],
Cell[25582, 704, 400, 5, 189, "Print"],
Cell[25985, 711, 509, 7, 243, "Print"],
Cell[26497, 720, 473, 7, 226, "Print"],
Cell[26973, 729, 400, 5, 189, "Print"],
Cell[27376, 736, 460, 6, 207, "Print"],
Cell[27839, 744, 458, 6, 207, "Print"],
Cell[28300, 752, 351, 5, 43, "Print"]
}, Open  ]],
Cell[28666, 760, 529, 7, 72, "Output"],
Cell[CellGroupData[{
Cell[29220, 771, 397, 5, 43, "Print"],
Cell[29620, 778, 96, 1, 24, "Print"],
Cell[29719, 781, 391, 5, 43, "Print"],
Cell[30113, 788, 98, 1, 24, "Print"],
Cell[30214, 791, 397, 5, 43, "Print"],
Cell[30614, 798, 391, 5, 43, "Print"],
Cell[31008, 805, 399, 5, 43, "Print"],
Cell[31410, 812, 401, 5, 43, "Print"],
Cell[31814, 819, 348, 4, 43, "Print"],
Cell[32165, 825, 457, 6, 43, "Print"],
Cell[32625, 833, 106, 1, 24, "Print"],
Cell[32734, 836, 505, 7, 62, "Print"],
Cell[33242, 845, 106, 1, 24, "Print"],
Cell[33351, 848, 459, 6, 43, "Print"],
Cell[33813, 856, 505, 7, 62, "Print"],
Cell[34321, 865, 568, 8, 62, "Print"],
Cell[34892, 875, 568, 8, 62, "Print"],
Cell[35463, 885, 519, 7, 62, "Print"],
Cell[35985, 894, 441, 6, 43, "Print"],
Cell[36429, 902, 447, 6, 43, "Print"],
Cell[36879, 910, 96, 1, 24, "Print"],
Cell[36978, 913, 447, 6, 43, "Print"],
Cell[37428, 921, 442, 6, 43, "Print"],
Cell[37873, 929, 98, 1, 24, "Print"],
Cell[37974, 932, 98, 1, 24, "Print"],
Cell[38075, 935, 98, 1, 24, "Print"],
Cell[38176, 938, 431, 6, 43, "Print"],
Cell[38610, 946, 397, 5, 43, "Print"],
Cell[39010, 953, 96, 1, 24, "Print"],
Cell[39109, 956, 391, 5, 43, "Print"],
Cell[39503, 963, 96, 1, 24, "Print"],
Cell[39602, 966, 399, 5, 43, "Print"],
Cell[40004, 973, 391, 5, 43, "Print"],
Cell[40398, 980, 399, 5, 43, "Print"],
Cell[40800, 987, 399, 5, 43, "Print"],
Cell[41202, 994, 348, 4, 43, "Print"],
Cell[41553, 1000, 535, 8, 62, "Print"],
Cell[42091, 1010, 533, 8, 62, "Print"],
Cell[42627, 1020, 518, 7, 62, "Print"],
Cell[43148, 1029, 432, 6, 43, "Print"],
Cell[43583, 1037, 373, 5, 43, "Print"],
Cell[43959, 1044, 254, 3, 24, "Print"]
}, Open  ]]
}, Open  ]]
}
]
*)

