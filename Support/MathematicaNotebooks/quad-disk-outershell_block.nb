(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     40619,        911]
NotebookOptionsPosition[     39090,        862]
NotebookOutlinePosition[     39424,        877]
CellTagsIndexPosition[     39381,        874]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"[", 
      RowBox[{"amin", ",", "amax"}], "]"}], " ", "are", " ", "the", " ", 
     "x"}], "-", 
    RowBox[{
    "corners", " ", "of", " ", "the", " ", "element", " ", "in", " ", "the", 
     " ", "topological", " ", 
     RowBox[{"space", " ", "[", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "]"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"[", 
      RowBox[{"bmin", ",", "bmax"}], "]"}], " ", "are", " ", "the", " ", 
     "x"}], "-", 
    RowBox[{
    "corners", " ", "of", " ", "the", " ", "element", " ", "in", " ", "the", 
     " ", "topological", " ", 
     RowBox[{"space", " ", "[", 
      RowBox[{"1", ",", "2"}], "]"}]}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.699546556880673*^9, 3.699546556881516*^9}, 
   3.699546668068795*^9, 3.699549373231655*^9, 3.699550523439896*^9, {
   3.700095466637554*^9, 3.700095466981565*^9}, {3.701905946349369*^9, 
   3.701905952206194*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", "r_", "]"}], ":=", 
   RowBox[{"amin", " ", "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"amax", "-", "amin"}], ")"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"r", "+", "1"}], ")"}], "/", "2"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b", "[", "s_", "]"}], ":=", 
   RowBox[{"bmin", " ", "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"bmax", "-", "bmin"}], ")"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"s", "+", "1"}], ")"}], "/", "2"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6995419796783953`*^9, 3.699542033818336*^9}, {
  3.699544419647629*^9, 3.699544421151099*^9}, {3.6995480954441853`*^9, 
  3.699548098390929*^9}, {3.6995481289073153`*^9, 3.6995481427235518`*^9}, {
  3.700095431128735*^9, 3.700095432882806*^9}, {3.7019058479237337`*^9, 
  3.701905848925592*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"R", "[", "s_", "]"}], "=", 
    RowBox[{
     RowBox[{"R1", "*", 
      RowBox[{"(", 
       RowBox[{"2.", "-", 
        RowBox[{"b", "[", "s", "]"}]}], ")"}]}], "+", 
     RowBox[{"R2", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"b", "[", "s", "]"}], "-", "1."}], ")"}]}]}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.701906110038374*^9, 3.701906112944865*^9}, {
  3.7065514934784813`*^9, 3.706551525290073*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"x", "[", "r_", "]"}], ":=", 
   RowBox[{"Tan", " ", "[", 
    RowBox[{
     RowBox[{"a", "[", "r", "]"}], "*", 
     RowBox[{"\[Pi]", "/", "4"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"q", "[", 
    RowBox[{"r_", ",", "s_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"R", "[", "s", "]"}], "/", 
    RowBox[{"Sqrt", " ", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "r", "]"}], "^", "2"}], "+", "1"}], "]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"xf", "[", 
    RowBox[{"r_", ",", "s_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"+", 
     RowBox[{"q", "[", 
      RowBox[{"r", ",", "s"}], "]"}]}], "*", 
    RowBox[{"x", "[", "r", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"yf", "[", 
    RowBox[{"r_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"+", 
    RowBox[{"q", "[", 
     RowBox[{"r", ",", "s"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.69954197218334*^9, 3.699541972184321*^9}, {
   3.699542129577129*^9, 3.699542220945642*^9}, {3.699543118381762*^9, 
   3.6995434063743362`*^9}, {3.699543816973815*^9, 3.699543824968581*^9}, {
   3.6995438748435307`*^9, 3.699543883914052*^9}, {3.699544413357587*^9, 
   3.699544418654728*^9}, {3.699546573829671*^9, 3.69954667122686*^9}, {
   3.699846093980824*^9, 3.699846095190308*^9}, {3.701905799894558*^9, 
   3.701905824076445*^9}, {3.701905858654089*^9, 3.701905867781049*^9}, 
   3.7019060120738173`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"xr", " ", "=", " ", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"xf", "[", 
       RowBox[{"r", ",", "s"}], "]"}], ",", "r"}], "]"}]}], ";", " ", 
   RowBox[{"xs", " ", "=", " ", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"xf", "[", 
       RowBox[{"r", ",", "s"}], "]"}], ",", "s"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"yr", " ", "=", " ", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"yf", "[", 
       RowBox[{"r", ",", "s"}], "]"}], ",", "r"}], "]"}]}], ";", " ", 
   RowBox[{"ys", " ", "=", " ", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"yf", "[", 
       RowBox[{"r", ",", "s"}], "]"}], ",", "s"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.702779513987832*^9, 3.702779518237679*^9}, {
  3.706430365388139*^9, 3.7064303850396967`*^9}, {3.706431075673993*^9, 
  3.706431076119247*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dxdr", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xr", ",", "xs"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"yr", ",", "ys"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J", " ", "=", " ", 
   RowBox[{
    RowBox[{"xr", "*", 
     RowBox[{"(", "ys", ")"}]}], "-", 
    RowBox[{"yr", "*", 
     RowBox[{"(", "xs", ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drdx", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", "ys", ")"}], "/", 
        RowBox[{"(", "J", ")"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", "xs", ")"}]}], "/", 
        RowBox[{"(", "J", ")"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", "yr", ")"}]}], "/", 
        RowBox[{"(", "J", ")"}]}], ",", 
       RowBox[{
        RowBox[{"(", "xr", ")"}], "/", 
        RowBox[{"(", "J", ")"}]}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drdxJ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", "ys", ")"}], ",", 
       RowBox[{"-", 
        RowBox[{"(", "xs", ")"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", "yr", ")"}]}], ",", 
       RowBox[{"(", "xr", ")"}]}], "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.702767921136414*^9, 3.702767972559712*^9}, {
   3.702768004826379*^9, 3.702768015603003*^9}, 3.702768077269484*^9, {
   3.702777238064062*^9, 3.7027773244753647`*^9}, {3.702778082050069*^9, 
   3.702778087077029*^9}, {3.702778327875937*^9, 3.702778374874288*^9}, {
   3.70277920718671*^9, 3.702779225061974*^9}, {3.702779361193205*^9, 
   3.702779377904117*^9}, {3.702920650314446*^9, 3.702920718604086*^9}, 
   3.7029433810049067`*^9, {3.706431080535851*^9, 3.7064310848798523`*^9}, {
   3.706431687546358*^9, 3.706431711698612*^9}, {3.7064318586590652`*^9, 
   3.7064318623973513`*^9}, {3.706431981422097*^9, 3.706432063799014*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<dxyz_drst[\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"i", "-", "1"}], "]"}], ",", "\"\<][\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"j", "-", "1"}], "]"}], ",", "\"\<] = \>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"CForm", "[", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"dxdr", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "]"}], ",", 
        "\"\<;\>\""}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", " ", 
        RowBox[{"\"\<Pi\>\"", "\[Rule]", "\"\<M_PI\>\""}], ",", 
        RowBox[{"\"\<Sin\>\"", "\[Rule]", "\"\<sin\>\""}], ",", 
        RowBox[{"\"\<Cos\>\"", "\[Rule]", "\"\<cos\>\""}], ",", 
        RowBox[{"\"\<Tan\>\"", "\[Rule]", "\"\<tan\>\""}], ",", 
        RowBox[{"\"\<Sqrt\>\"", "->", "\"\<sqrt\>\""}], ",", 
        RowBox[{"\"\<Sec\>\"", "\[Rule]", "\"\<secant_fcn\>\""}]}], "}"}]}], 
     "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<jacobian = \>\"", ",", 
     RowBox[{"ToString", "[", 
      RowBox[{"CForm", "[", 
       RowBox[{"Simplify", "[", "J", "]"}], "]"}], " ", "]"}], " ", ",", " ", 
     "\"\<;\>\""}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", " ", 
     RowBox[{"\"\<Pi\>\"", "\[Rule]", "\"\<M_PI\>\""}], ",", 
     RowBox[{"\"\<Sin\>\"", "\[Rule]", "\"\<sin\>\""}], ",", 
     RowBox[{"\"\<Cos\>\"", "\[Rule]", "\"\<cos\>\""}], ",", 
     RowBox[{"\"\<Tan\>\"", "\[Rule]", "\"\<tan\>\""}], ",", 
     RowBox[{"\"\<Sqrt\>\"", "->", "\"\<sqrt\>\""}], ",", 
     RowBox[{"\"\<Sec\>\"", "\[Rule]", "\"\<secant_fcn\>\""}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<drst_dxyz[\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"i", "-", "1"}], "]"}], ",", "\"\<][\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"j", "-", "1"}], "]"}], ",", "\"\<] = \>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"CForm", "[", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"drdx", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "]"}], ",", 
        "\"\<;\>\""}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", " ", 
        RowBox[{"\"\<Pi\>\"", "\[Rule]", "\"\<M_PI\>\""}], ",", 
        RowBox[{"\"\<Sin\>\"", "\[Rule]", "\"\<sin\>\""}], ",", 
        RowBox[{"\"\<Cos\>\"", "\[Rule]", "\"\<cos\>\""}], ",", 
        RowBox[{"\"\<Tan\>\"", "\[Rule]", "\"\<tan\>\""}], ",", 
        RowBox[{"\"\<Sqrt\>\"", "->", "\"\<sqrt\>\""}], ",", 
        RowBox[{"\"\<Sec\>\"", "\[Rule]", "\"\<secant_fcn\>\""}]}], "}"}]}], 
     "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<drst_dxyz_times_jac[\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"i", "-", "1"}], "]"}], ",", "\"\<][\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"j", "-", "1"}], "]"}], ",", "\"\<] = \>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"CForm", "[", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"drdxJ", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "]"}], ",", 
        "\"\<;\>\""}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", " ", 
        RowBox[{"\"\<Pi\>\"", "\[Rule]", "\"\<M_PI\>\""}], ",", 
        RowBox[{"\"\<Sin\>\"", "\[Rule]", "\"\<sin\>\""}], ",", 
        RowBox[{"\"\<Cos\>\"", "\[Rule]", "\"\<cos\>\""}], ",", 
        RowBox[{"\"\<Tan\>\"", "\[Rule]", "\"\<tan\>\""}], ",", 
        RowBox[{"\"\<Sqrt\>\"", "->", "\"\<sqrt\>\""}], ",", 
        RowBox[{"\"\<Sec\>\"", "\[Rule]", "\"\<secant_fcn\>\""}]}], "}"}]}], 
     "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<drdxJdrdx[\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"i", "-", "1"}], "]"}], ",", "\"\<][\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"j", "-", "1"}], "]"}], ",", "\"\<] = \>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"CForm", "[", 
          RowBox[{"Simplify", "[", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"drdxJ", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{
               RowBox[{"drdx", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], "]"}], "]"}],
          "]"}], ",", "\"\<;\>\""}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", " ", 
        RowBox[{"\"\<Pi\>\"", "\[Rule]", "\"\<M_PI\>\""}], ",", 
        RowBox[{"\"\<Sin\>\"", "\[Rule]", "\"\<sin\>\""}], ",", 
        RowBox[{"\"\<Cos\>\"", "\[Rule]", "\"\<cos\>\""}], ",", 
        RowBox[{"\"\<Tan\>\"", "\[Rule]", "\"\<tan\>\""}], ",", 
        RowBox[{"\"\<Sqrt\>\"", "->", "\"\<sqrt\>\""}], ",", 
        RowBox[{"\"\<Sec\>\"", "\[Rule]", "\"\<secant_fcn\>\""}]}], "}"}]}], 
     "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<drst_dxyz[\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"i", "-", "1"}], "]"}], ",", "\"\<][\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"j", "-", "1"}], "]"}], ",", "\"\<] = \>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"CForm", "[", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"drdx", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "]"}], ",", 
        "\"\<;\>\""}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", " ", 
        RowBox[{"\"\<Pi\>\"", "\[Rule]", "\"\<M_PI\>\""}], ",", 
        RowBox[{"\"\<Sin\>\"", "\[Rule]", "\"\<sin\>\""}], ",", 
        RowBox[{"\"\<Cos\>\"", "\[Rule]", "\"\<cos\>\""}], ",", 
        RowBox[{"\"\<Tan\>\"", "\[Rule]", "\"\<tan\>\""}], ",", 
        RowBox[{"\"\<Sqrt\>\"", "->", "\"\<sqrt\>\""}], ",", 
        RowBox[{"\"\<Sec\>\"", "\[Rule]", "\"\<secant_fcn\>\""}]}], "}"}]}], 
     "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<sj_sqr_vol[\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"i", "-", "1"}], "]"}], ",", "\"\<] = \>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"CForm", "[", 
          RowBox[{"Simplify", "[", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"drdxJ", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{
               RowBox[{"drdxJ", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], "]"}], "]"}],
          "]"}], ",", "\"\<;\>\""}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", " ", 
        RowBox[{"\"\<Pi\>\"", "\[Rule]", "\"\<M_PI\>\""}], ",", 
        RowBox[{"\"\<Sin\>\"", "\[Rule]", "\"\<sin\>\""}], ",", 
        RowBox[{"\"\<Cos\>\"", "\[Rule]", "\"\<cos\>\""}], ",", 
        RowBox[{"\"\<Tan\>\"", "\[Rule]", "\"\<tan\>\""}], ",", 
        RowBox[{"\"\<Sqrt\>\"", "->", "\"\<sqrt\>\""}], ",", 
        RowBox[{"\"\<Sec\>\"", "\[Rule]", "\"\<secant_fcn\>\""}]}], "}"}]}], 
     "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "2"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<sj_sqr_div_J_sqr_vol[\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"i", "-", "1"}], "]"}], ",", "\"\<] = \>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"CForm", "[", 
          RowBox[{"Simplify", "[", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"drdx", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{
               RowBox[{"drdx", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], "]"}], "]"}],
          "]"}], ",", "\"\<;\>\""}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", " ", 
        RowBox[{"\"\<Pi\>\"", "\[Rule]", "\"\<M_PI\>\""}], ",", 
        RowBox[{"\"\<Sin\>\"", "\[Rule]", "\"\<sin\>\""}], ",", 
        RowBox[{"\"\<Cos\>\"", "\[Rule]", "\"\<cos\>\""}], ",", 
        RowBox[{"\"\<Tan\>\"", "\[Rule]", "\"\<tan\>\""}], ",", 
        RowBox[{"\"\<Sqrt\>\"", "->", "\"\<sqrt\>\""}], ",", 
        RowBox[{"\"\<Sec\>\"", "\[Rule]", "\"\<secant_fcn\>\""}]}], "}"}]}], 
     "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "2"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.702778489546298*^9, 3.702778594954393*^9}, {
   3.702778625551796*^9, 3.702778626464368*^9}, {3.70277868394108*^9, 
   3.7027788308919477`*^9}, {3.702778901658266*^9, 3.702779035406241*^9}, {
   3.702779197247562*^9, 3.702779202315544*^9}, {3.7027795307489634`*^9, 
   3.7027795782886477`*^9}, {3.7027796984286203`*^9, 3.702779711578933*^9}, {
   3.702779743306527*^9, 3.70277981029527*^9}, {3.7028287944763308`*^9, 
   3.7028288114599447`*^9}, {3.702841379060328*^9, 3.702841380930273*^9}, {
   3.70386130848212*^9, 3.7038614255164413`*^9}, {3.703861546626275*^9, 
   3.7038615581185226`*^9}, {3.7038631598925343`*^9, 3.703863182520393*^9}, {
   3.704057107312101*^9, 3.7040571117985277`*^9}, {3.706432115375414*^9, 
   3.706432115447947*^9}, 3.7065481445317087`*^9}],

Cell[CellGroupData[{

Cell[BoxData["\<\"dxyz_drst[0][0] = (0.19634954084936207*(amax - \
1.*amin)*(R1*(4. + bmax*(-1. - 1.*s) + bmin*(-1. + s)) + R2*(-2. + bmax + \
bmin + bmax*s - 1.*bmin*s))*sqrt(pow(secant_fcn((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)))/(1. + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2));\"\>"], "Print",
 CellChangeTimes->{3.70654904703834*^9, 3.7065515281351013`*^9, 
  3.7065516541412287`*^9}],

Cell[BoxData["\<\"dxyz_drst[0][1] = -((bmax - bmin)*(R1 - R2)*tan((M_PI*(amax \
+ amin + amax*r - amin*r))/8.))/(2.*sqrt(pow(secant_fcn((M_PI*(amax + amin + \
amax*r - amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{3.70654904703834*^9, 3.7065515281351013`*^9, 
  3.706551654143083*^9}],

Cell[BoxData["\<\"dxyz_drst[1][0] = (-0.19634954084936207*(amax - \
1.*amin)*(R1*(4. + bmax*(-1. - 1.*s) + bmin*(-1. + s)) + R2*(-2. + bmax + \
bmin + bmax*s - 1.*bmin*s))*sqrt(pow(secant_fcn((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2))*tan((M_PI*(amax + amin + amax*r - amin*r))/8.))/(1. + \
pow(tan((M_PI*(amax + amin + amax*r - amin*r))/8.),2));\"\>"], "Print",
 CellChangeTimes->{3.70654904703834*^9, 3.7065515281351013`*^9, 
  3.706551654288563*^9}],

Cell[BoxData["\<\"dxyz_drst[1][1] = -((bmax - bmin)*(R1 - \
R2))/(2.*sqrt(pow(secant_fcn((M_PI*(amax + amin + amax*r - amin*r))/8.),2)));\
\"\>"], "Print",
 CellChangeTimes->{3.70654904703834*^9, 3.7065515281351013`*^9, 
  3.7065516543693733`*^9}]
}, Open  ]],

Cell[BoxData["\<\"jacobian = 0. + \
amin*(pow(bmax,2)*(pow(R1,2)*(-0.09817477042468103 - 0.09817477042468103*s) + \
pow(R2,2)*(-0.09817477042468103 - 0.09817477042468103*s) + \
R1*R2*(0.19634954084936207 + 0.19634954084936207*s)) + \
bmax*(R1*R2*(-0.5890486225480862 - 0.39269908169872414*bmin*s) + \
pow(R2,2)*(0.19634954084936207 + 0.19634954084936207*bmin*s) + \
pow(R1,2)*(0.39269908169872414 + 0.19634954084936207*bmin*s)) + \
bmin*(pow(R1,2)*(-0.39269908169872414 + 0.09817477042468103*bmin - \
0.09817477042468103*bmin*s) + pow(R2,2)*(-0.19634954084936207 + \
0.09817477042468103*bmin - 0.09817477042468103*bmin*s) + \
R1*R2*(0.5890486225480862 - 0.19634954084936207*bmin + \
0.19634954084936207*bmin*s))) + \
amax*(pow(bmax,2)*(R1*R2*(-0.19634954084936207 - 0.19634954084936207*s) + \
pow(R1,2)*(0.09817477042468103 + 0.09817477042468103*s) + \
pow(R2,2)*(0.09817477042468103 + 0.09817477042468103*s)) + \
bmin*(R1*R2*(-0.5890486225480862 + 0.19634954084936207*bmin - \
0.19634954084936207*bmin*s) + pow(R2,2)*(0.19634954084936207 - \
0.09817477042468103*bmin + 0.09817477042468103*bmin*s) + \
pow(R1,2)*(0.39269908169872414 - 0.09817477042468103*bmin + \
0.09817477042468103*bmin*s)) + bmax*(pow(R1,2)*(-0.39269908169872414 - \
0.19634954084936207*bmin*s) + pow(R2,2)*(-0.19634954084936207 - \
0.19634954084936207*bmin*s) + R1*R2*(0.5890486225480862 + \
0.39269908169872414*bmin*s)));\"\>"], "Output",
 CellChangeTimes->{3.706549047606944*^9, 3.7065515285240297`*^9, 
  3.706551654483405*^9}],

Cell[CellGroupData[{

Cell[BoxData["\<\"drst_dxyz[0][0] = (5.092958178940651*(bmax - 1.*bmin)*(R1 - \
1.*R2))/((amax*(pow(bmax,2)*(pow(R1,2)*(-1. - 1.*s) + pow(R2,2)*(-1. - 1.*s) \
+ R1*R2*(2. + 2.*s)) + bmax*(R1*R2*(-6. - 4.*bmin*s) + pow(R2,2)*(2. + \
2.*bmin*s) + pow(R1,2)*(4. + 2.*bmin*s)) + bmin*(pow(R1,2)*(-4. + 1.*bmin - \
1.*bmin*s) + pow(R2,2)*(-2. + 1.*bmin - 1.*bmin*s) + R1*R2*(6. - 2.*bmin + \
2.*bmin*s))) + amin*(pow(bmax,2)*(R1*R2*(-2. - 2.*s) + pow(R1,2)*(1. + 1.*s) \
+ pow(R2,2)*(1. + 1.*s)) + bmin*(R1*R2*(-6. + 2.*bmin - 2.*bmin*s) + \
pow(R2,2)*(2. - 1.*bmin + 1.*bmin*s) + pow(R1,2)*(4. - 1.*bmin + 1.*bmin*s)) \
+ bmax*(pow(R1,2)*(-4. - 2.*bmin*s) + pow(R2,2)*(-2. - 2.*bmin*s) + R1*R2*(6. \
+ 4.*bmin*s))))*sqrt(pow(secant_fcn((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{3.70654904703834*^9, 3.7065515281351013`*^9, 
  3.706551654927988*^9}],

Cell[BoxData["\<\"drst_dxyz[0][1] = (-5.092958178940651*(bmax - 1.*bmin)*(R1 \
- 1.*R2)*tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.))/((amax*(pow(bmax,2)*(pow(R1,2)*(-1. - 1.*s) + pow(R2,2)*(-1. - \
1.*s) + R1*R2*(2. + 2.*s)) + bmax*(R1*R2*(-6. - 4.*bmin*s) + pow(R2,2)*(2. + \
2.*bmin*s) + pow(R1,2)*(4. + 2.*bmin*s)) + bmin*(pow(R1,2)*(-4. + 1.*bmin - \
1.*bmin*s) + pow(R2,2)*(-2. + 1.*bmin - 1.*bmin*s) + R1*R2*(6. - 2.*bmin + \
2.*bmin*s))) + amin*(pow(bmax,2)*(R1*R2*(-2. - 2.*s) + pow(R1,2)*(1. + 1.*s) \
+ pow(R2,2)*(1. + 1.*s)) + bmin*(R1*R2*(-6. + 2.*bmin - 2.*bmin*s) + \
pow(R2,2)*(2. - 1.*bmin + 1.*bmin*s) + pow(R1,2)*(4. - 1.*bmin + 1.*bmin*s)) \
+ bmax*(pow(R1,2)*(-4. - 2.*bmin*s) + pow(R2,2)*(-2. - 2.*bmin*s) + R1*R2*(6. \
+ 4.*bmin*s))))*sqrt(pow(secant_fcn((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{3.70654904703834*^9, 3.7065515281351013`*^9, 
  3.7065516554637547`*^9}],

Cell[BoxData["\<\"drst_dxyz[1][0] = ((amax - amin)*M_PI*(0.5*R1*(4. + \
bmax*(-1. - 1.*s) + bmin*(-1. + s)) + 0.5*R2*(-2. + bmax + bmin + bmax*s - \
1.*bmin*s))*tan((M_PI*(amax + amin + amax*r - amin*r))/8.))/(8.*(0. + \
amin*(pow(bmax,2)*(pow(R1,2)*(-0.09817477042468103 - 0.09817477042468103*s) + \
pow(R2,2)*(-0.09817477042468103 - 0.09817477042468103*s) + \
R1*R2*(0.19634954084936207 + 0.19634954084936207*s)) + \
bmax*(R1*R2*(-0.5890486225480862 - 0.39269908169872414*bmin*s) + \
pow(R2,2)*(0.19634954084936207 + 0.19634954084936207*bmin*s) + \
pow(R1,2)*(0.39269908169872414 + 0.19634954084936207*bmin*s)) + \
bmin*(pow(R1,2)*(-0.39269908169872414 + 0.09817477042468103*bmin - \
0.09817477042468103*bmin*s) + pow(R2,2)*(-0.19634954084936207 + \
0.09817477042468103*bmin - 0.09817477042468103*bmin*s) + \
R1*R2*(0.5890486225480862 - 0.19634954084936207*bmin + \
0.19634954084936207*bmin*s))) + \
amax*(pow(bmax,2)*(R1*R2*(-0.19634954084936207 - 0.19634954084936207*s) + \
pow(R1,2)*(0.09817477042468103 + 0.09817477042468103*s) + \
pow(R2,2)*(0.09817477042468103 + 0.09817477042468103*s)) + \
bmin*(R1*R2*(-0.5890486225480862 + 0.19634954084936207*bmin - \
0.19634954084936207*bmin*s) + pow(R2,2)*(0.19634954084936207 - \
0.09817477042468103*bmin + 0.09817477042468103*bmin*s) + \
pow(R1,2)*(0.39269908169872414 - 0.09817477042468103*bmin + \
0.09817477042468103*bmin*s)) + bmax*(pow(R1,2)*(-0.39269908169872414 - \
0.19634954084936207*bmin*s) + pow(R2,2)*(-0.19634954084936207 - \
0.19634954084936207*bmin*s) + R1*R2*(0.5890486225480862 + \
0.39269908169872414*bmin*s))))*sqrt(pow(secant_fcn((M_PI*(amax + amin + \
amax*r - amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{3.70654904703834*^9, 3.7065515281351013`*^9, 
  3.706551657120719*^9}],

Cell[BoxData["\<\"drst_dxyz[1][1] = (0.19634954084936207*(amax - \
1.*amin)*(R1*(4. + bmax*(-1. - 1.*s) + bmin*(-1. + s)) + R2*(-2. + bmax + \
bmin + bmax*s - 1.*bmin*s))*sqrt(pow(secant_fcn((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)))/((amin*(pow(bmax,2)*(pow(R1,2)*(-0.09817477042468103 - \
0.09817477042468103*s) + pow(R2,2)*(-0.09817477042468103 - \
0.09817477042468103*s) + R1*R2*(0.19634954084936207 + 0.19634954084936207*s)) \
+ bmax*(R1*R2*(-0.5890486225480862 - 0.39269908169872414*bmin*s) + \
pow(R2,2)*(0.19634954084936207 + 0.19634954084936207*bmin*s) + \
pow(R1,2)*(0.39269908169872414 + 0.19634954084936207*bmin*s)) + \
bmin*(pow(R1,2)*(-0.39269908169872414 + 0.09817477042468103*bmin - \
0.09817477042468103*bmin*s) + pow(R2,2)*(-0.19634954084936207 + \
0.09817477042468103*bmin - 0.09817477042468103*bmin*s) + \
R1*R2*(0.5890486225480862 - 0.19634954084936207*bmin + \
0.19634954084936207*bmin*s))) + \
amax*(pow(bmax,2)*(R1*R2*(-0.19634954084936207 - 0.19634954084936207*s) + \
pow(R1,2)*(0.09817477042468103 + 0.09817477042468103*s) + \
pow(R2,2)*(0.09817477042468103 + 0.09817477042468103*s)) + \
bmin*(R1*R2*(-0.5890486225480862 + 0.19634954084936207*bmin - \
0.19634954084936207*bmin*s) + pow(R2,2)*(0.19634954084936207 - \
0.09817477042468103*bmin + 0.09817477042468103*bmin*s) + \
pow(R1,2)*(0.39269908169872414 - 0.09817477042468103*bmin + \
0.09817477042468103*bmin*s)) + bmax*(pow(R1,2)*(-0.39269908169872414 - \
0.19634954084936207*bmin*s) + pow(R2,2)*(-0.19634954084936207 - \
0.19634954084936207*bmin*s) + R1*R2*(0.5890486225480862 + \
0.39269908169872414*bmin*s))))*(1. + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{3.70654904703834*^9, 3.7065515281351013`*^9, 
  3.706551660626849*^9}],

Cell[BoxData["\<\"drst_dxyz_times_jac[0][0] = -((bmax - bmin)*(R1 - \
R2))/(2.*sqrt(pow(secant_fcn((M_PI*(amax + amin + amax*r - amin*r))/8.),2)));\
\"\>"], "Print",
 CellChangeTimes->{3.70654904703834*^9, 3.7065515281351013`*^9, 
  3.706551660630081*^9}],

Cell[BoxData["\<\"drst_dxyz_times_jac[0][1] = ((bmax - bmin)*(R1 - \
R2)*tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.))/(2.*sqrt(pow(secant_fcn((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{3.70654904703834*^9, 3.7065515281351013`*^9, 
  3.706551660804731*^9}],

Cell[BoxData["\<\"drst_dxyz_times_jac[1][0] = (0.19634954084936207*(amax - \
1.*amin)*(R1*(4. + bmax*(-1. - 1.*s) + bmin*(-1. + s)) + R2*(-2. + bmax + \
bmin + bmax*s - 1.*bmin*s))*sqrt(pow(secant_fcn((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2))*tan((M_PI*(amax + amin + amax*r - amin*r))/8.))/(1. + \
pow(tan((M_PI*(amax + amin + amax*r - amin*r))/8.),2));\"\>"], "Print",
 CellChangeTimes->{3.70654904703834*^9, 3.7065515281351013`*^9, 
  3.7065516608592663`*^9}],

Cell[BoxData["\<\"drst_dxyz_times_jac[1][1] = (0.19634954084936207*(amax - \
1.*amin)*(R1*(4. + bmax*(-1. - 1.*s) + bmin*(-1. + s)) + R2*(-2. + bmax + \
bmin + bmax*s - 1.*bmin*s))*sqrt(pow(secant_fcn((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)))/(1. + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2));\"\>"], "Print",
 CellChangeTimes->{3.70654904703834*^9, 3.7065515281351013`*^9, 
  3.706551660861067*^9}],

Cell[BoxData["\<\"drdxJdrdx[0][0] = (-2.5464790894703255*pow(bmax - \
1.*bmin,2)*pow(R1 - 1.*R2,2))/(0. + amax*(pow(bmax,2)*(pow(R1,2)*(-1. - 1.*s) \
+ pow(R2,2)*(-1. - 1.*s) + R1*R2*(2. + 2.*s)) + bmax*(R1*R2*(-6. - 4.*bmin*s) \
+ pow(R2,2)*(2. + 2.*bmin*s) + pow(R1,2)*(4. + 2.*bmin*s)) + \
bmin*(pow(R1,2)*(-4. + 1.*bmin - 1.*bmin*s) + pow(R2,2)*(-2. + 1.*bmin - \
1.*bmin*s) + R1*R2*(6. - 2.*bmin + 2.*bmin*s))) + \
amin*(pow(bmax,2)*(R1*R2*(-2. - 2.*s) + pow(R1,2)*(1. + 1.*s) + pow(R2,2)*(1. \
+ 1.*s)) + bmin*(R1*R2*(-6. + 2.*bmin - 2.*bmin*s) + pow(R2,2)*(2. - 1.*bmin \
+ 1.*bmin*s) + pow(R1,2)*(4. - 1.*bmin + 1.*bmin*s)) + bmax*(pow(R1,2)*(-4. - \
2.*bmin*s) + pow(R2,2)*(-2. - 2.*bmin*s) + R1*R2*(6. + 4.*bmin*s))));\"\>"], \
"Print",
 CellChangeTimes->{3.70654904703834*^9, 3.7065515281351013`*^9, 
  3.706551661588788*^9}],

Cell[BoxData["\<\"drdxJdrdx[0][1] = 0.;\"\>"], "Print",
 CellChangeTimes->{3.70654904703834*^9, 3.7065515281351013`*^9, 
  3.706551662065271*^9}],

Cell[BoxData["\<\"drdxJdrdx[1][0] = 0.;\"\>"], "Print",
 CellChangeTimes->{3.70654904703834*^9, 3.7065515281351013`*^9, 
  3.7065516620664263`*^9}],

Cell[BoxData["\<\"drdxJdrdx[1][1] = (pow(amax - \
amin,2)*pow(M_PI,2)*pow(0.5*R1*(4. + bmax*(-1. - 1.*s) + bmin*(-1. + s)) + \
0.5*R2*(-2. + bmax + bmin + bmax*s - 1.*bmin*s),2))/(64.*(0. + \
amin*(pow(bmax,2)*(pow(R1,2)*(-0.09817477042468103 - 0.09817477042468103*s) + \
pow(R2,2)*(-0.09817477042468103 - 0.09817477042468103*s) + \
R1*R2*(0.19634954084936207 + 0.19634954084936207*s)) + \
bmax*(R1*R2*(-0.5890486225480862 - 0.39269908169872414*bmin*s) + \
pow(R2,2)*(0.19634954084936207 + 0.19634954084936207*bmin*s) + \
pow(R1,2)*(0.39269908169872414 + 0.19634954084936207*bmin*s)) + \
bmin*(pow(R1,2)*(-0.39269908169872414 + 0.09817477042468103*bmin - \
0.09817477042468103*bmin*s) + pow(R2,2)*(-0.19634954084936207 + \
0.09817477042468103*bmin - 0.09817477042468103*bmin*s) + \
R1*R2*(0.5890486225480862 - 0.19634954084936207*bmin + \
0.19634954084936207*bmin*s))) + \
amax*(pow(bmax,2)*(R1*R2*(-0.19634954084936207 - 0.19634954084936207*s) + \
pow(R1,2)*(0.09817477042468103 + 0.09817477042468103*s) + \
pow(R2,2)*(0.09817477042468103 + 0.09817477042468103*s)) + \
bmin*(R1*R2*(-0.5890486225480862 + 0.19634954084936207*bmin - \
0.19634954084936207*bmin*s) + pow(R2,2)*(0.19634954084936207 - \
0.09817477042468103*bmin + 0.09817477042468103*bmin*s) + \
pow(R1,2)*(0.39269908169872414 - 0.09817477042468103*bmin + \
0.09817477042468103*bmin*s)) + bmax*(pow(R1,2)*(-0.39269908169872414 - \
0.19634954084936207*bmin*s) + pow(R2,2)*(-0.19634954084936207 - \
0.19634954084936207*bmin*s) + R1*R2*(0.5890486225480862 + \
0.39269908169872414*bmin*s)))));\"\>"], "Print",
 CellChangeTimes->{3.70654904703834*^9, 3.7065515281351013`*^9, 
  3.706551690643609*^9}],

Cell[BoxData["\<\"drst_dxyz[0][0] = (5.092958178940651*(bmax - 1.*bmin)*(R1 - \
1.*R2))/((amax*(pow(bmax,2)*(pow(R1,2)*(-1. - 1.*s) + pow(R2,2)*(-1. - 1.*s) \
+ R1*R2*(2. + 2.*s)) + bmax*(R1*R2*(-6. - 4.*bmin*s) + pow(R2,2)*(2. + \
2.*bmin*s) + pow(R1,2)*(4. + 2.*bmin*s)) + bmin*(pow(R1,2)*(-4. + 1.*bmin - \
1.*bmin*s) + pow(R2,2)*(-2. + 1.*bmin - 1.*bmin*s) + R1*R2*(6. - 2.*bmin + \
2.*bmin*s))) + amin*(pow(bmax,2)*(R1*R2*(-2. - 2.*s) + pow(R1,2)*(1. + 1.*s) \
+ pow(R2,2)*(1. + 1.*s)) + bmin*(R1*R2*(-6. + 2.*bmin - 2.*bmin*s) + \
pow(R2,2)*(2. - 1.*bmin + 1.*bmin*s) + pow(R1,2)*(4. - 1.*bmin + 1.*bmin*s)) \
+ bmax*(pow(R1,2)*(-4. - 2.*bmin*s) + pow(R2,2)*(-2. - 2.*bmin*s) + R1*R2*(6. \
+ 4.*bmin*s))))*sqrt(pow(secant_fcn((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{3.70654904703834*^9, 3.7065515281351013`*^9, 
  3.70655169064664*^9}],

Cell[BoxData["\<\"drst_dxyz[0][1] = (-5.092958178940651*(bmax - 1.*bmin)*(R1 \
- 1.*R2)*tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.))/((amax*(pow(bmax,2)*(pow(R1,2)*(-1. - 1.*s) + pow(R2,2)*(-1. - \
1.*s) + R1*R2*(2. + 2.*s)) + bmax*(R1*R2*(-6. - 4.*bmin*s) + pow(R2,2)*(2. + \
2.*bmin*s) + pow(R1,2)*(4. + 2.*bmin*s)) + bmin*(pow(R1,2)*(-4. + 1.*bmin - \
1.*bmin*s) + pow(R2,2)*(-2. + 1.*bmin - 1.*bmin*s) + R1*R2*(6. - 2.*bmin + \
2.*bmin*s))) + amin*(pow(bmax,2)*(R1*R2*(-2. - 2.*s) + pow(R1,2)*(1. + 1.*s) \
+ pow(R2,2)*(1. + 1.*s)) + bmin*(R1*R2*(-6. + 2.*bmin - 2.*bmin*s) + \
pow(R2,2)*(2. - 1.*bmin + 1.*bmin*s) + pow(R1,2)*(4. - 1.*bmin + 1.*bmin*s)) \
+ bmax*(pow(R1,2)*(-4. - 2.*bmin*s) + pow(R2,2)*(-2. - 2.*bmin*s) + R1*R2*(6. \
+ 4.*bmin*s))))*sqrt(pow(secant_fcn((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{3.70654904703834*^9, 3.7065515281351013`*^9, 
  3.706551691242708*^9}],

Cell[BoxData["\<\"drst_dxyz[1][0] = ((amax - amin)*M_PI*(0.5*R1*(4. + \
bmax*(-1. - 1.*s) + bmin*(-1. + s)) + 0.5*R2*(-2. + bmax + bmin + bmax*s - \
1.*bmin*s))*tan((M_PI*(amax + amin + amax*r - amin*r))/8.))/(8.*(0. + \
amin*(pow(bmax,2)*(pow(R1,2)*(-0.09817477042468103 - 0.09817477042468103*s) + \
pow(R2,2)*(-0.09817477042468103 - 0.09817477042468103*s) + \
R1*R2*(0.19634954084936207 + 0.19634954084936207*s)) + \
bmax*(R1*R2*(-0.5890486225480862 - 0.39269908169872414*bmin*s) + \
pow(R2,2)*(0.19634954084936207 + 0.19634954084936207*bmin*s) + \
pow(R1,2)*(0.39269908169872414 + 0.19634954084936207*bmin*s)) + \
bmin*(pow(R1,2)*(-0.39269908169872414 + 0.09817477042468103*bmin - \
0.09817477042468103*bmin*s) + pow(R2,2)*(-0.19634954084936207 + \
0.09817477042468103*bmin - 0.09817477042468103*bmin*s) + \
R1*R2*(0.5890486225480862 - 0.19634954084936207*bmin + \
0.19634954084936207*bmin*s))) + \
amax*(pow(bmax,2)*(R1*R2*(-0.19634954084936207 - 0.19634954084936207*s) + \
pow(R1,2)*(0.09817477042468103 + 0.09817477042468103*s) + \
pow(R2,2)*(0.09817477042468103 + 0.09817477042468103*s)) + \
bmin*(R1*R2*(-0.5890486225480862 + 0.19634954084936207*bmin - \
0.19634954084936207*bmin*s) + pow(R2,2)*(0.19634954084936207 - \
0.09817477042468103*bmin + 0.09817477042468103*bmin*s) + \
pow(R1,2)*(0.39269908169872414 - 0.09817477042468103*bmin + \
0.09817477042468103*bmin*s)) + bmax*(pow(R1,2)*(-0.39269908169872414 - \
0.19634954084936207*bmin*s) + pow(R2,2)*(-0.19634954084936207 - \
0.19634954084936207*bmin*s) + R1*R2*(0.5890486225480862 + \
0.39269908169872414*bmin*s))))*sqrt(pow(secant_fcn((M_PI*(amax + amin + \
amax*r - amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{3.70654904703834*^9, 3.7065515281351013`*^9, 
  3.706551692816451*^9}],

Cell[BoxData["\<\"drst_dxyz[1][1] = (0.19634954084936207*(amax - \
1.*amin)*(R1*(4. + bmax*(-1. - 1.*s) + bmin*(-1. + s)) + R2*(-2. + bmax + \
bmin + bmax*s - 1.*bmin*s))*sqrt(pow(secant_fcn((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)))/((amin*(pow(bmax,2)*(pow(R1,2)*(-0.09817477042468103 - \
0.09817477042468103*s) + pow(R2,2)*(-0.09817477042468103 - \
0.09817477042468103*s) + R1*R2*(0.19634954084936207 + 0.19634954084936207*s)) \
+ bmax*(R1*R2*(-0.5890486225480862 - 0.39269908169872414*bmin*s) + \
pow(R2,2)*(0.19634954084936207 + 0.19634954084936207*bmin*s) + \
pow(R1,2)*(0.39269908169872414 + 0.19634954084936207*bmin*s)) + \
bmin*(pow(R1,2)*(-0.39269908169872414 + 0.09817477042468103*bmin - \
0.09817477042468103*bmin*s) + pow(R2,2)*(-0.19634954084936207 + \
0.09817477042468103*bmin - 0.09817477042468103*bmin*s) + \
R1*R2*(0.5890486225480862 - 0.19634954084936207*bmin + \
0.19634954084936207*bmin*s))) + \
amax*(pow(bmax,2)*(R1*R2*(-0.19634954084936207 - 0.19634954084936207*s) + \
pow(R1,2)*(0.09817477042468103 + 0.09817477042468103*s) + \
pow(R2,2)*(0.09817477042468103 + 0.09817477042468103*s)) + \
bmin*(R1*R2*(-0.5890486225480862 + 0.19634954084936207*bmin - \
0.19634954084936207*bmin*s) + pow(R2,2)*(0.19634954084936207 - \
0.09817477042468103*bmin + 0.09817477042468103*bmin*s) + \
pow(R1,2)*(0.39269908169872414 - 0.09817477042468103*bmin + \
0.09817477042468103*bmin*s)) + bmax*(pow(R1,2)*(-0.39269908169872414 - \
0.19634954084936207*bmin*s) + pow(R2,2)*(-0.19634954084936207 - \
0.19634954084936207*bmin*s) + R1*R2*(0.5890486225480862 + \
0.39269908169872414*bmin*s))))*(1. + pow(tan((M_PI*(amax + amin + amax*r - \
amin*r))/8.),2)));\"\>"], "Print",
 CellChangeTimes->{3.70654904703834*^9, 3.7065515281351013`*^9, 
  3.706551692819592*^9}],

Cell[BoxData["\<\"sj_sqr_vol[0] = (pow(bmax - bmin,2)*pow(R1 - \
R2,2))/4.;\"\>"], "Print",
 CellChangeTimes->{3.70654904703834*^9, 3.7065515281351013`*^9, 
  3.706551692833128*^9}],

Cell[BoxData["\<\"sj_sqr_vol[1] = (pow(amax - \
amin,2)*pow(M_PI,2)*pow(0.5*R1*(4. + bmax*(-1. - 1.*s) + bmin*(-1. + s)) + \
0.5*R2*(-2. + bmax + bmin + bmax*s - 1.*bmin*s),2))/64.;\"\>"], "Print",
 CellChangeTimes->{3.70654904703834*^9, 3.7065515281351013`*^9, 
  3.7065516931786957`*^9}],

Cell[BoxData["\<\"sj_sqr_div_J_sqr_vol[0] = (25.93822301243847*pow(bmax - \
1.*bmin,2)*pow(R1 - 1.*R2,2))/pow(0. + amax*(pow(bmax,2)*(pow(R1,2)*(-1. - \
1.*s) + pow(R2,2)*(-1. - 1.*s) + R1*R2*(2. + 2.*s)) + bmax*(R1*R2*(-6. - \
4.*bmin*s) + pow(R2,2)*(2. + 2.*bmin*s) + pow(R1,2)*(4. + 2.*bmin*s)) + \
bmin*(pow(R1,2)*(-4. + 1.*bmin - 1.*bmin*s) + pow(R2,2)*(-2. + 1.*bmin - \
1.*bmin*s) + R1*R2*(6. - 2.*bmin + 2.*bmin*s))) + \
amin*(pow(bmax,2)*(R1*R2*(-2. - 2.*s) + pow(R1,2)*(1. + 1.*s) + pow(R2,2)*(1. \
+ 1.*s)) + bmin*(R1*R2*(-6. + 2.*bmin - 2.*bmin*s) + pow(R2,2)*(2. - 1.*bmin \
+ 1.*bmin*s) + pow(R1,2)*(4. - 1.*bmin + 1.*bmin*s)) + bmax*(pow(R1,2)*(-4. - \
2.*bmin*s) + pow(R2,2)*(-2. - 2.*bmin*s) + R1*R2*(6. + \
4.*bmin*s))),2);\"\>"], "Print",
 CellChangeTimes->{3.70654904703834*^9, 3.7065515281351013`*^9, 
  3.7065516935698643`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 1200},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.0 for Linux x86 (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1162, 33, 83, "Input"],
Cell[1723, 55, 924, 26, 59, "Input"],
Cell[2650, 83, 515, 16, 52, "Input"],
Cell[3168, 101, 1470, 42, 99, "Input"],
Cell[4641, 145, 960, 29, 71, "Input"],
Cell[5604, 176, 2127, 62, 92, "Input"],
Cell[CellGroupData[{
Cell[7756, 242, 12012, 279, 371, "Input"],
Cell[CellGroupData[{
Cell[19793, 525, 412, 6, 43, "Print"],
Cell[20208, 533, 292, 4, 24, "Print"],
Cell[20503, 539, 458, 6, 43, "Print"],
Cell[20964, 547, 247, 4, 24, "Print"]
}, Open  ]],
Cell[21226, 554, 1501, 24, 152, "Output"],
Cell[CellGroupData[{
Cell[22752, 582, 888, 12, 81, "Print"],
Cell[23643, 596, 940, 13, 81, "Print"],
Cell[24586, 611, 1755, 27, 157, "Print"],
Cell[26344, 640, 1771, 27, 157, "Print"],
Cell[28118, 669, 255, 4, 24, "Print"],
Cell[28376, 675, 303, 5, 24, "Print"],
Cell[28682, 682, 469, 6, 43, "Print"],
Cell[29154, 690, 420, 6, 43, "Print"],
Cell[29577, 698, 836, 12, 81, "Print"],
Cell[30416, 712, 145, 2, 24, "Print"],
Cell[30564, 716, 147, 2, 24, "Print"],
Cell[30714, 720, 1657, 26, 157, "Print"],
Cell[32374, 748, 887, 12, 81, "Print"],
Cell[33264, 762, 938, 13, 81, "Print"],
Cell[34205, 777, 1755, 27, 157, "Print"],
Cell[35963, 806, 1771, 27, 157, "Print"],
Cell[37737, 835, 181, 3, 24, "Print"],
Cell[37921, 840, 289, 4, 24, "Print"],
Cell[38213, 846, 849, 12, 81, "Print"]
}, Open  ]]
}, Open  ]]
}
]
*)

